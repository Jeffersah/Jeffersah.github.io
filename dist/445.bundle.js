"use strict";(self.webpackChunktrading_game=self.webpackChunktrading_game||[]).push([[445],{3130:(e,t,n)=>{function r(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(console.error(n),alert(`An error occurred compiling the ${t===e.VERTEX_SHADER?"vertex":t===e.FRAGMENT_SHADER?"fragment":""} shaders: `+e.getShaderInfoLog(r)),void e.deleteShader(r))}function o(e,t,n){const o=r(e,e.VERTEX_SHADER,t),a=r(e,e.FRAGMENT_SHADER,n),i=e.createProgram();if(e.attachShader(i,o),e.attachShader(i,a),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS))return i;alert("Unable to initialize the shader program: "+e.getProgramInfoLog(i))}function a(e,t,n,r,o,a,i,s){e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);{const o=e.FLOAT,a=!1,i=0,s=0;e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(e.getAttribLocation(t,"aVertexPosition"),r,o,a,i,s),e.enableVertexAttribArray(e.getAttribLocation(t,"aVertexPosition"))}e.useProgram(t);for(let t=0;t<a;t++){s(e,t);let{bufferOffset:n,bufferCount:r}=i(t);e.drawArrays("triangle"===o?e.TRIANGLES:"tristrip"===o?e.TRIANGLE_STRIP:e.TRIANGLE_FAN,n,r)}}function i(e,t,n,r){e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);{const r=2,o=e.FLOAT,a=!1,i=0,s=0;e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(e.getAttribLocation(t,"aVertexPosition"),r,o,a,i,s),e.enableVertexAttribArray(e.getAttribLocation(t,"aVertexPosition"))}e.useProgram(t),r(e),e.drawArrays(e.TRIANGLE_STRIP,0,4)}function s(e,t,n,r,o){const a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a);const i=null!=t?t:-1,s=null!=r?r:1,c=null!=n?n:-1,l=null!=o?o:1,u=[l,s,c,s,l,i,c,i];return e.bufferData(e.ARRAY_BUFFER,new Float32Array(u),e.STATIC_DRAW),a}function c(e,t){const n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),n}n.d(t,{nr:()=>o,f:()=>a,os:()=>i,nW:()=>s,jK:()=>c,B_:()=>l,FC:()=>u});const l="attribute vec4 aVertexPosition;\nvarying vec3 vPos;\nvoid main() {\n  vPos = vec3(aVertexPosition.xy, 0.0);\n  gl_Position = aVertexPosition;\n}",u="#version 300 es\nin vec4 aVertexPosition;\nout vec3 vPos;\nvoid main() {\n  vPos = vec3(aVertexPosition.xy, 0.0);\n  gl_Position = aVertexPosition;\n}"},483:(e,t,n)=>{n.d(t,{Z:()=>r});const r=new class{constructor(){this.Name="Fire",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    if(perc <= 0.5) {\n        return vec3(perc * 2.0, perc, 0.0);\n    }\n    perc = (perc - 0.5) * 2.0;\n    return vec3(1.0, 0.5 + perc / 2.0, perc);\n}\n    "}}},811:(e,t,n)=>{n.d(t,{Z:()=>r});const r=new class{constructor(){this.Name="Grayscale",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    return vec3(perc, perc, perc);\n}\n    "}}},6:(e,t,n)=>{n.d(t,{Z:()=>r});const r=new class{constructor(){this.Name="Hue",this.shaderFunction="\n\nfloat fmod(float a, float b) {\n    return a - (b * floor(a/b));\n}\n\nfloat hsvComponentToRgb(vec3 hsv, float n) {\n    float k = fmod((n + hsv.x * 6.0), 6.0);\n    return hsv.z - hsv.z * hsv.y * max(min(min(k, 4.0-k),1.0), 0.0);\n}\n\nvec3 floatToColor(float perc) {\n    if(perc == 1.0) {\n        return vec3(0, 0, 0);\n    }\n    vec3 hsv = vec3(perc, 1.0, 1.0);\n    return vec3(\n        hsvComponentToRgb(hsv, 5.0),\n        hsvComponentToRgb(hsv, 3.0),\n        hsvComponentToRgb(hsv, 1.0)\n    );\n}\n    "}}},788:(e,t,n)=>{n.d(t,{Z:()=>r});const r=new class{constructor(){this.Name="Paper",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    if(perc == 1.0) {\n        return vec3(0, 0, 0);\n    }\n    return vec3(0.8, 0.8, 0.8) - (perc * 0.8);\n}\n    "}}},290:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var r=n(3804),o=n(483),a=n(811),i=n(6);const s=[n(788).Z,i.Z,a.Z,o.Z];function c(e,t){return e.map(((e,n)=>e+t[n]))}function l(e,t){return[e[0]*t[0]-e[1]*t[1]-e[2]*t[2]-e[3]*t[3],e[0]*t[1]+e[1]*t[0]-e[2]*t[3]+e[3]*t[2],e[0]*t[2]+e[1]*t[3]+e[2]*t[0]-e[3]*t[1],e[0]*t[3]-e[1]*t[2]+e[2]*t[1]+e[3]*t[0]]}const u=new class{constructor(){this.Name="Burning Ship",this.ShaderCode="\n        vec4 zabs = abs(z);\n        return c_mult(zabs, zabs) + c;\n    ",this.MaxAmplitude=16}Iterate(e,t){let n=e.map(Math.abs);return c(l(n,n),t)}},h=[new class{constructor(){this.Name="Mandelbrot",this.ShaderCode="return c_mult(z, z) + c;",this.MaxAmplitude=2}Iterate(e,t){return c(l(e,e),t)}},u];var f=n(3130);class d{constructor(e){this.canvas=e,this.gl=e.getContext("webgl2")}init(e,t){const n=this.gl,r=_.replace("[[[FRACTAL_CODE]]]",e.ShaderCode).replace("[[[COLOR_CODE]]]",t.shaderFunction).replace("[[[MAX_DIST]]]",e.MaxAmplitude.toFixed(2));this.program=f.nr(n,f.FC,r),this.buffer=f.nW(n),n.bindBuffer(n.ARRAY_BUFFER,this.buffer);const o=n.getAttribLocation(this.program,"aVertexPosition");n.vertexAttribPointer(o,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(o),n.useProgram(this.program),this.uniforms={u_window_pos:n.getUniformLocation(this.program,"u_window_pos"),u_window_size:n.getUniformLocation(this.program,"u_window_size"),u_x_axis:n.getUniformLocation(this.program,"u_x_axis"),u_y_axis:n.getUniformLocation(this.program,"u_y_axis"),u_z_slice:n.getUniformLocation(this.program,"u_z_slice")}}destroy(){const e=this.gl;e.deleteProgram(this.program),e.deleteBuffer(this.buffer)}render(e,t,n,r,o){let a=[this.canvas.clientWidth,this.canvas.clientHeight];this.canvas.width=a[0],this.canvas.height=a[1],this.gl.viewport(0,0,a[0],a[1]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.uniform2f(this.uniforms.u_window_pos,e,t),this.gl.uniform2f(this.uniforms.u_window_size,r,o),this.gl.uniform3f(this.uniforms.u_x_axis,1,0,0),this.gl.uniform3f(this.uniforms.u_y_axis,0,1,0),this.gl.uniform3f(this.uniforms.u_z_slice,0,0,n),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}const _="#version 300 es\n\nprecision highp float;\nuniform vec2 u_window_pos;\nuniform vec2 u_window_size;\n\nuniform vec3 u_x_axis;\nuniform vec3 u_y_axis;\nuniform vec3 u_z_slice;\n\nout vec4 outColor;\n\nconst float MAX_ABSSQ = [[[MAX_DIST]]];\n\nin vec3 vPos;\n\nconst int MAX_ITER = 256;\n\nvec4 c_mult(vec4 a, vec4 b) {\n    return vec4(\n        a.x*b.x - a.y*b.y - a.z*b.z - a.w*b.w,\n        a.x*b.y + a.y*b.x - a.z*b.w + a.w*b.z,\n        a.x*b.z + a.y*b.w + a.z*b.x - a.w*b.y,\n        a.x*b.w - a.y*b.z + a.z*b.y + a.w*b.x\n    );\n}\n\nfloat cplx_abssq(vec4 v) {\n    return dot(v, v);\n}\n\nvec4 step_fractal(vec4 z, vec4 c) {\n[[[FRACTAL_CODE]]]\n}\n\nfloat calcIterations(vec4 coords) {\n    vec4 roll = vec4(0,0,0,0);\n    for(int iter = 0; iter < MAX_ITER; iter++) {\n        roll = step_fractal(roll, coords);\n        if (cplx_abssq(roll) >= MAX_ABSSQ) {\n            return float(iter)/float(MAX_ITER);\n        }\n    }\n    return 1.0;\n}\n\n[[[COLOR_CODE]]]\n\nvoid main() {\n    vec2 adjPos = vPos.xy;\n    adjPos += 1.0;\n    adjPos /= 2.0;\n    // adjpos is now 0, 1\n    // Convert that to world-space\n    adjPos = u_window_pos + adjPos * u_window_size;\n\n    vec3 c3 = adjPos.x * u_x_axis + adjPos.y * u_y_axis + u_z_slice;\n\n    vec4 c = vec4(\n        c3.x,\n        -c3.y,\n        c3.z,\n        0.0\n    );\n\n    float mb_perc = calcIterations(c);\n    outColor = vec4(floatToColor(mb_perc), 1.0);\n}\n";class v{constructor(e,t){this.canvas2d=e,this.canvas3d=t,this.sliceRenderer=new d(e)}start(e,t){this.sliceRenderer.init(e,t),this.sliceRenderer.render(-1,-1,0,2,2)}destroy(){this.sliceRenderer.destroy()}}function m(){const[e,t]=r.useState(h[0]),[n,o]=r.useState(s[0]),a=r.useRef(null),i=r.useRef(null);return r.useEffect((()=>{if(null===a.current||null===i.current)return;const t=new v(a.current,i.current);return t.start(e,n),()=>t.destroy()}),[a.current,i.current,e,n]),r.createElement("div",{className:"flex col align-stretch full_body"},r.createElement("div",{className:"flex row"},r.createElement("select",{onChange:e=>t(h[e.target.selectedIndex])},h.map((t=>r.createElement("option",{selected:t===e,key:t.Name},t.Name)))),r.createElement("select",{onChange:e=>o(s[e.target.selectedIndex])},s.map((e=>r.createElement("option",{selected:e===n,key:e.Name},e.Name))))),r.createElement("div",{className:"flex row align-stretch"},r.createElement("div",{style:{width:"50%",height:"100%"}},r.createElement("canvas",{ref:a,style:{width:"100%",height:"100%"}})),r.createElement("div",{style:{width:"50%",height:"100%"}},r.createElement("canvas",{ref:i,style:{width:"100%",height:"100%"}}))))}}}]);
//# sourceMappingURL=445.bundle.js.map