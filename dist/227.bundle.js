/*! For license information please see 227.bundle.js.LICENSE.txt */
(self.webpackChunktrading_game=self.webpackChunktrading_game||[]).push([[227],{4403:(t,e)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)&&n.length){var s=a.apply(null,n);s&&t.push(s)}else if("object"===i)for(var o in n)r.call(n,o)&&n[o]&&t.push(o)}}return t.join(" ")}t.exports?(a.default=a,t.exports=a):void 0===(n=function(){return a}.apply(e,[]))||(t.exports=n)}()},8167:(t,e,n)=>{"use strict";e.Z=void 0;var r,a=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var i=r?Object.getOwnPropertyDescriptor(t,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}(n(3804)),i=(r=n(4403))&&r.__esModule?r:{default:r};function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f="Select...",m=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?h(t):e}(this,u(e).call(this,t))).state={selected:n.parseValue(t.value,t.options)||{label:void 0===t.placeholder?f:t.placeholder,value:""},isOpen:!1},n.dropdownRef=(0,a.createRef)(),n.mounted=!0,n.handleDocumentClick=n.handleDocumentClick.bind(h(n)),n.fireChangeEvent=n.fireChangeEvent.bind(h(n)),n}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,t),n=e,(r=[{key:"componentDidUpdate",value:function(t){if(this.props.value!==t.value)if(this.props.value){var e=this.parseValue(this.props.value,this.props.options);e!==this.state.selected&&this.setState({selected:e})}else this.setState({selected:{label:void 0===this.props.placeholder?f:this.props.placeholder,value:""}})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick,!1),document.addEventListener("touchend",this.handleDocumentClick,!1)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,document.removeEventListener("click",this.handleDocumentClick,!1),document.removeEventListener("touchend",this.handleDocumentClick,!1)}},{key:"handleMouseDown",value:function(t){this.props.onFocus&&"function"==typeof this.props.onFocus&&this.props.onFocus(this.state.isOpen),"mousedown"===t.type&&0!==t.button||(t.stopPropagation(),t.preventDefault(),this.props.disabled||this.setState({isOpen:!this.state.isOpen}))}},{key:"parseValue",value:function(t,e){var n;if("string"==typeof t)for(var r=0,a=e.length;r<a;r++)if("group"===e[r].type){var i=e[r].items.filter((function(e){return e.value===t}));i.length&&(n=i[0])}else void 0!==e[r].value&&e[r].value===t&&(n=e[r]);return n||t}},{key:"setValue",value:function(t,e){var n={selected:{value:t,label:e},isOpen:!1};this.fireChangeEvent(n),this.setState(n)}},{key:"fireChangeEvent",value:function(t){t.selected!==this.state.selected&&this.props.onChange&&this.props.onChange(t.selected)}},{key:"renderOption",value:function(t){var e,n=t.value;void 0===n&&(n=t.label||t);var r=t.label||t.value||t,s=n===this.state.selected.value||n===this.state.selected,o=(c(e={},"".concat(this.props.baseClassName,"-option"),!0),c(e,t.className,!!t.className),c(e,"is-selected",s),e),l=(0,i.default)(o);return a.default.createElement("div",{key:n,className:l,onMouseDown:this.setValue.bind(this,n,r),onClick:this.setValue.bind(this,n,r),role:"option","aria-selected":s?"true":"false"},r)}},{key:"buildMenu",value:function(){var t=this,e=this.props,n=e.options,r=e.baseClassName,i=n.map((function(e){if("group"===e.type){var n=a.default.createElement("div",{className:"".concat(r,"-title")},e.name),i=e.items.map((function(e){return t.renderOption(e)}));return a.default.createElement("div",{className:"".concat(r,"-group"),key:e.name,role:"listbox",tabIndex:"-1"},n,i)}return t.renderOption(e)}));return i.length?i:a.default.createElement("div",{className:"".concat(r,"-noresults")},"No options found")}},{key:"handleDocumentClick",value:function(t){this.mounted&&(this.dropdownRef.current.contains(t.target)||this.state.isOpen&&this.setState({isOpen:!1}))}},{key:"isValueSelected",value:function(){return"string"==typeof this.state.selected||""!==this.state.selected.value}},{key:"render",value:function(){var t,e,n,r,s,o=this.props,l=o.baseClassName,u=o.controlClassName,h=o.placeholderClassName,d=o.menuClassName,f=o.arrowClassName,m=o.arrowClosed,p=o.arrowOpen,v=o.className,y=this.props.disabled?"Dropdown-disabled":"",g="string"==typeof this.state.selected?this.state.selected:this.state.selected.label,x=(0,i.default)((c(t={},"".concat(l,"-root"),!0),c(t,v,!!v),c(t,"is-open",this.state.isOpen),t)),b=(0,i.default)((c(e={},"".concat(l,"-control"),!0),c(e,u,!!u),c(e,y,!!y),e)),w=(0,i.default)((c(n={},"".concat(l,"-placeholder"),!0),c(n,h,!!h),c(n,"is-selected",this.isValueSelected()),n)),_=(0,i.default)((c(r={},"".concat(l,"-menu"),!0),c(r,d,!!d),r)),A=(0,i.default)((c(s={},"".concat(l,"-arrow"),!0),c(s,f,!!f),s)),E=a.default.createElement("div",{className:w},g),C=this.state.isOpen?a.default.createElement("div",{className:_,"aria-expanded":"true"},this.buildMenu()):null;return a.default.createElement("div",{ref:this.dropdownRef,className:x},a.default.createElement("div",{className:b,onMouseDown:this.handleMouseDown.bind(this),onTouchEnd:this.handleMouseDown.bind(this),"aria-haspopup":"listbox"},E,a.default.createElement("div",{className:"".concat(l,"-arrow-wrapper")},p&&m?this.state.isOpen?p:m:a.default.createElement("span",{className:A}))),C)}}])&&l(n.prototype,r),e}(a.Component);m.defaultProps={baseClassName:"Dropdown"};var p=m;e.Z=p},3130:(t,e,n)=>{"use strict";function r(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.error(n),alert(`An error occurred compiling the ${e===t.VERTEX_SHADER?"vertex":e===t.FRAGMENT_SHADER?"fragment":""} shaders: `+t.getShaderInfoLog(r)),void t.deleteShader(r))}function a(t,e,n){const a=r(t,t.VERTEX_SHADER,e),i=r(t,t.FRAGMENT_SHADER,n),s=t.createProgram();if(t.attachShader(s,a),t.attachShader(s,i),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS))return s;alert("Unable to initialize the shader program: "+t.getProgramInfoLog(s))}function i(t,e,n,r,a,i,s,o){t.clearColor(0,0,0,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);{const a=t.FLOAT,i=!1,s=0,o=0;t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(t.getAttribLocation(e,"aVertexPosition"),r,a,i,s,o),t.enableVertexAttribArray(t.getAttribLocation(e,"aVertexPosition"))}t.useProgram(e);for(let e=0;e<i;e++){o(t,e);let{bufferOffset:n,bufferCount:r}=s(e);t.drawArrays("triangle"===a?t.TRIANGLES:"tristrip"===a?t.TRIANGLE_STRIP:t.TRIANGLE_FAN,n,r)}}function s(t,e,n,r){t.clearColor(0,0,0,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);{const r=2,a=t.FLOAT,i=!1,s=0,o=0;t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(t.getAttribLocation(e,"aVertexPosition"),r,a,i,s,o),t.enableVertexAttribArray(t.getAttribLocation(e,"aVertexPosition"))}t.useProgram(e),r(t),t.drawArrays(t.TRIANGLE_STRIP,0,4)}function o(t,e,n,r,a){const i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);const s=null!=e?e:-1,o=null!=r?r:1,c=null!=n?n:-1,l=null!=a?a:1,u=[l,o,c,o,l,s,c,s];return t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),i}function c(t,e){const n=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),n}n.d(e,{nr:()=>a,f:()=>i,os:()=>s,nW:()=>o,jK:()=>c,B_:()=>l,FC:()=>u});const l="attribute vec4 aVertexPosition;\nvarying vec3 vPos;\nvoid main() {\n  vPos = vec3(aVertexPosition.xy, 0.0);\n  gl_Position = aVertexPosition;\n}",u="#version 300 es\nin vec4 aVertexPosition;\nout vec3 vPos;\nvoid main() {\n  vPos = vec3(aVertexPosition.xy, 0.0);\n  gl_Position = aVertexPosition;\n}"},8785:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t,e){this.x=t,this.y=e}static zero(){return new r(0,0)}static fromAngle(t,e){return new r(Math.cos(t)*(null!=e?e:1),Math.sin(t)*(null!=e?e:1))}lengthSq(){return r.dot(this,this)}length(){return Math.sqrt(this.lengthSq())}clone(){return new r(this.x,this.y)}negate(){return new r(-this.x,-this.y)}negateInPlace(){return this.x=-this.x,this.y=-this.y,this}static dot(t,e){return t.x*e.x+t.y*e.y}dotWith(t){return r.dot(this,t)}normalize(){let t=this.length();return r.multiply(this,1/t)}direction(){return Math.atan2(this.y,this.x)}truncate(){return new r(Math.trunc(this.x),Math.trunc(this.y))}addWith(t,e){const{x:n,y:r}=a(t,e);return this.x+=n,this.y+=r,this}multWith(t,e){const{x:n,y:r}=function(t,e){return void 0===e?void 0!==t.x?{x:t.x,y:t.y}:{x:t,y:t}:{x:t,y:e}}(t,e);return this.x*=n,this.y*=r,this}subtractWith(t,e){const{x:n,y:r}=a(t,e);return this.x-=n,this.y-=r,this}divideWith(t,e){const{x:n,y:r}=a(t,e);return this.x/=n,this.y/=r,this}equals(t){return this.x===t.x&&this.y===t.y}static add(t,e,n){const{x:i,y:s}=a(e,n);return new r(t.x+i,t.y+s)}static subtract(t,e,n){const{x:i,y:s}=a(e,n);return new r(t.x-i,t.y-s)}static multiply(t,e,n){return void 0!==n?new r(t.x*e,t.y*n):void 0!==e.x?new r(t.x*e.x,t.y*e.y):new r(t.x*e,t.y*e)}static interpolate(t,e,n){return new r(t.x+(e.x-t.x)*n,t.y+(e.y-t.y)*n)}static componentMin(t,e){return t.x<=e.x&&t.y<=e.y?t:e.x<=t.x&&e.y<=t.y?e:new r(Math.min(t.x,e.x),Math.min(t.y,e.y))}static componentMax(t,e){return t.x>=e.x&&t.y>=e.y?t:e.x>=t.x&&e.y>=t.y?e:new r(Math.max(t.x,e.x),Math.max(t.y,e.y))}static Bezier(t,e){return 1===t.length?t[0]:2===t.length?r.add(r.multiply(t[1],e),r.multiply(t[0],1-e)):r.add(r.multiply(r.Bezier(t.slice(1),e),e),r.multiply(r.Bezier(t.slice(0,t.length-1),e),1-e))}rotate(t){const e=Math.atan2(this.y,this.x),n=this.length();return r.fromAngle(e+t,n)}}function a(t,e){return void 0===e?{x:t.x,y:t.y}:{x:t,y:e}}},3483:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new class{constructor(){this.Name="Fire",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    if(perc <= 0.5) {\n        return vec3(perc * 2.0, perc, 0.0);\n    }\n    perc = (perc - 0.5) * 2.0;\n    return vec3(1.0, 0.5 + perc / 2.0, perc);\n}\n    "}}},4811:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new class{constructor(){this.Name="Grayscale",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    return vec3(perc, perc, perc);\n}\n    "}}},8006:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new class{constructor(){this.Name="Hue",this.shaderFunction="\n\nfloat fmod(float a, float b) {\n    return a - (b * floor(a/b));\n}\n\nfloat hsvComponentToRgb(vec3 hsv, float n) {\n    float k = fmod((n + hsv.x * 6.0), 6.0);\n    return hsv.z - hsv.z * hsv.y * max(min(min(k, 4.0-k),1.0), 0.0);\n}\n\nvec3 floatToColor(float perc) {\n    if(perc == 1.0) {\n        return vec3(0, 0, 0);\n    }\n    vec3 hsv = vec3(perc, 1.0, 1.0);\n    return vec3(\n        hsvComponentToRgb(hsv, 5.0),\n        hsvComponentToRgb(hsv, 3.0),\n        hsvComponentToRgb(hsv, 1.0)\n    );\n}\n    "}}},3788:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new class{constructor(){this.Name="Paper",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    if(perc == 1.0) {\n        return vec3(0, 0, 0);\n    }\n    return vec3(0.8, 0.8, 0.8) - (perc * 0.8);\n}\n    "}}},4077:(t,e,n)=>{"use strict";n.d(e,{f:()=>i});var r=n(3804),a=n(8167);function i(t){const e=t.options.map(t.getName);return r.createElement(a.Z,{options:e,value:t.getName(t.value),onChange:e=>t.onChange(t.options.find((n=>t.getName(n)===e.value)))})}},6227:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>R});var r=n(3804),a=n(3123);const i=[new class{constructor(){this.Name="Fill"}GetAmplitude(t,e,n){return{min:t,max:e}}},new class{constructor(){this.Name="Square"}GetAmplitude(t,e,n){const r=a.Zz.subtract(e,t);if(r.real===r.imaginary)return{min:t,max:e};if(r.real>r.imaginary){var i=(r.real-r.imaginary)/2,s=new a.Zz(0,i);return{min:a.Zz.subtract(t,s),max:a.Zz.add(e,s)}}return i=(r.imaginary-r.real)/2,s=new a.Zz(i,0),{min:a.Zz.subtract(t,s),max:a.Zz.add(e,s)}}},new class{constructor(){this.Name="Absolute"}GetAmplitude(t,e,n){return{min:new a.Zz(-n.MaxAmplitude,-n.MaxAmplitude),max:new a.Zz(n.MaxAmplitude,n.MaxAmplitude)}}}];var s=n(3483),o=n(4811),c=n(8006),l=n(3788),u=n(5901),h=n(9401);class d{constructor(t,e){this.canvas=t,this.amplitude=e,(0,u.f5)(t,t.clientWidth,t.clientHeight),this.ctx=t.getContext("2d"),this.audio=new AudioContext,this.gain=this.audio.createGain(),this.gain.gain.value=.3,this.gain.connect(this.audio.destination)}Cleanup(){this.audio.close()}Play(t,e){var n;null===(n=this.currentAudio)||void 0===n||n.stop(),this.currentAudio=new f(this.audio,t,e,this.amplitude),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="red",this.currentAudio.start(this.gain),this.ctx.beginPath();const r=h.Z.add(this.currentAudio.maxBounds,h.Z.negate(this.currentAudio.minBounds));for(let t=0;t<this.currentAudio.arr.length;t++){const e=(this.currentAudio.arr[t].real-this.currentAudio.minBounds.real)/r.real,n=(this.currentAudio.arr[t].imaginary-this.currentAudio.minBounds.imaginary)/r.imaginary,a=e*this.canvas.width,i=n*this.canvas.height;0===t?this.ctx.moveTo(a,i):this.ctx.lineTo(a,i)}this.ctx.stroke()}}class f{constructor(t,e,n,r){this.audio=t,this.point=e,this.fractal=n,this.amplitude=r,this.arr=new Array(8820);const a=e;let i=n.Init(a);this.minBounds=new h.Z(1/0,1/0),this.maxBounds=new h.Z(-1/0,-1/0);for(let t=0;t<this.arr.length;t++)i=n.Iterate(i,a),this.arr[t]=new h.Z(i.real,i.imaginary),this.minBounds.real=Math.min(this.minBounds.real,i.real),this.minBounds.imaginary=Math.min(this.minBounds.imaginary,i.imaginary),this.maxBounds.real=Math.max(this.maxBounds.real,i.real),this.maxBounds.imaginary=Math.max(this.maxBounds.imaginary,i.imaginary);const s=r.GetAmplitude(this.minBounds,this.maxBounds,n);this.minBounds=s.min,this.maxBounds=s.max}start(t){const e=this.audio.createBuffer(2,8820,8820),n=this.audio.createBufferSource(),r=[e.getChannelData(0),e.getChannelData(1)],a=h.Z.add(this.maxBounds,h.Z.negate(this.minBounds));for(let t=0;t<r[0].length;t++){const e=8820*t/8820,n=Math.max(0,Math.floor(e)),i=(Math.min(this.arr.length-1,Math.ceil(e)),this.arr[n].real),s=this.arr[n].imaginary,o=(i-this.minBounds.real)/a.real,c=(s-this.minBounds.imaginary)/a.imaginary;r[0][t]=2*o-1,r[1][t]=2*c-1}n.buffer=e,n.connect(t),n.start(),this.source=n}stop(){var t;null===(t=this.source)||void 0===t||t.stop()}}const m=new class{constructor(){this.Name="Burning Ship",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return vec2(0,0);\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        float tx = v.x * v.x - v.y * v.y - c.x;\n        float ty = 2.0 * abs(v.x * v.y) - c.y;\n        return vec2(tx, ty);\n    }\n    ",this.MaxAmplitude=16}Init(t){return t}Iterate(t,e){const n=t.real*t.real-t.imaginary*t.imaginary-e.real,r=2*Math.abs(t.real*t.imaginary)-e.imaginary;return new a.Zz(n,r)}},p=new class{constructor(){this.Name="Feather",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return coords;\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        vec2 denom = scalar_mult(v, v);\n        denom.x += 1.0;\n        vec2 num = cplx_mult(cplx_mult(v, v), v);\n        vec2 result = cplx_div(num, denom);\n        return result + c;\n    }\n    ",this.MaxAmplitude=32}Init(t){return t}Iterate(t,e){return a.Zz.div(a.Zz.mult(t,t).multiplyWith(t),a.Zz.scalarMultiply(t,t).addWith(new a.Zz(1,0))).addWith(e)}},v=new class{constructor(){this.Name="Mandelbrot",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return coords;\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        return cplx_mult(v, v) + c;\n    }\n    ",this.MaxAmplitude=2}Init(t){return t}Iterate(t,e){return a.Zz.mult(t,t).addWith(e)}},y=new class{constructor(){this.Name="Square",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return coords;\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        float dotz = dot(v, v);\n        vec2 scalarc = scalar_mult(c, c);\n        return v * dotz - cplx_mult(v, scalarc);\n    }\n    ",this.MaxAmplitude=32}Init(t){return t}Iterate(t,e){const n=t.absSq(),r=a.Zz.scalarMultiply(e,e);return a.Zz.subtract(a.Zz.scalarMultiply(t,n,n),a.Zz.mult(e,r))}};var g=n(3130),x=n(8785);class b{constructor(t,e,n,r,i){this.canvas=t,this.fractal=e,this.color=n,this.bounds=r,this.onMiddleClick=i,(0,u.f5)(t,t.clientWidth,t.clientHeight),this.cursor_anchor=null,this.mm_down=!1,this.gl=t.getContext("webgl"),this.touch_anchors={},this.canvasRange=new a.gS(new a.e6(0,t.clientWidth),new a.e6(0,t.clientHeight)),this.windowRange=new a.gS(new a.e6(-1,1),new a.e6(-1,t.height/t.width)),this.fragment_code=function(t,e){return"\nprecision highp float;\nvarying vec3 vPos;\nuniform vec2 window_pos;\nuniform vec2 window_size;\nuniform float MAX_ABSSQ;\n\nconst int MAX_ITER = 256;\n\nvec2 cplx_mult(vec2 a, vec2 b) {\n    return vec2(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}\n\nvec2 cplx_div(vec2 a, vec2 b) {\n    float denom = dot(b, b);\n    return vec2 (\n        (a.x * b.x + a.y * b.y) / denom,\n        (a.y * b.x - a.x * b.y) / denom \n    );\n}\n\nvec2 scalar_mult(vec2 a, vec2 b) {\n    return vec2( a.x * b.x, a.y * b.y);\n}\n\nfloat cplx_abssq(vec2 v) {\n    return dot(v, v);\n}\n\n[[[FRACTAL_CODE]]]\n\nfloat calcIterations(vec2 coords) {\n    vec2 roll = init_fractal(coords);\n    for(int iter = 0; iter < MAX_ITER; iter++) {\n        roll = step_fractal(roll, coords);\n        if (cplx_abssq(roll) >= MAX_ABSSQ) {\n            return float(iter)/float(MAX_ITER);\n        }\n    }\n    return 1.0;\n}\n\n[[[COLOR_CODE]]]\n\nvoid main() {\n    vec2 adjpos = vPos.xy;\n    adjpos += 1.0;\n    adjpos /= 2.0;\n    // adjpos is now 0, 1\n    // Convert that to world-space\n    adjpos = window_pos + adjpos * window_size;\n\n    float mb_perc = calcIterations(adjpos);\n    gl_FragColor = vec4(floatToColor(mb_perc), 1.0);\n}".replace("[[[FRACTAL_CODE]]]",t.ShaderCode).replace("[[[COLOR_CODE]]]",e.shaderFunction)}(e,n),this.init()}init(){this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.initProgram()}initProgram(){this.program=g.nr(this.gl,g.B_,this.fragment_code),this.buffer=g.nW(this.gl)}run(){this.renderFrame(),this.canvas.addEventListener("mousedown",(t=>{if(0===t.button)this.cursor_anchor=new x.Z(t.offsetX,t.offsetY);else if(1===t.button){this.mm_down=!0;let e=this.canvasRange.GetPercentage(t.offsetX,t.offsetY);e=this.windowRange.GetValue(e.x,1-e.y),void 0!==this.onMiddleClick&&this.onMiddleClick(new x.Z(e.x,e.y))}t.preventDefault()})),this.canvas.addEventListener("mouseup",(t=>{0===t.button?this.cursor_anchor=null:1===t.button&&(this.mm_down=!1),t.preventDefault()})),this.canvas.addEventListener("mousemove",(t=>{if(null!=this.cursor_anchor){const e=t.offsetX-this.cursor_anchor.x,n=t.offsetY-this.cursor_anchor.y;this.panCameraByScreenDelta(new x.Z(e,n)),this.cursor_anchor=new x.Z(t.offsetX,t.offsetY),this.renderFrame(),t.preventDefault()}if(this.mm_down&&void 0!==this.onMiddleClick){let e=this.canvasRange.GetPercentage(t.offsetX,t.offsetY);e=this.windowRange.GetValue(e.x,1-e.y),this.onMiddleClick(new x.Z(e.x,e.y))}})),this.canvas.addEventListener("wheel",(t=>{const e=t.deltaY/8,n=Math.pow(1.1,e),r=this.canvasRange.GetPercentage(t.offsetX,t.offsetY);this.windowRange.AspectScale(n,r.x,1-r.y),this.renderFrame(),t.preventDefault()})),this.canvas.addEventListener("touchstart",(t=>{if(!(t.targetTouches.length>=3||0===t.targetTouches.length)){for(let e=0;e<t.targetTouches.length;e++){const n=t.targetTouches.item(e);this.touch_anchors[n.identifier]=w(n)}t.preventDefault()}})),this.canvas.addEventListener("touchmove",(t=>{if(t.touches.length>=3||0===t.touches.length)return;const e=[];for(let n=0;n<t.targetTouches.length;n++){const r=t.targetTouches.item(n),a=w(r),i=this.touch_anchors[r.identifier];if(void 0===i)return;e.push([i,a]),this.touch_anchors[r.identifier]=a}if(1===e.length)this.panCameraByScreenDelta(x.Z.subtract(e[0][1],e[0][0]));else if(2===e.length){const t=x.Z.multiply(x.Z.add(e[0][0],e[1][0]),.5,.5),n=x.Z.multiply(x.Z.add(e[0][1],e[1][1]),.5,.5),r=this.panCameraByScreenDelta(n.subtractWith(t)),a=x.Z.subtract(e[0][0],e[1][0]).length()/x.Z.subtract(e[0][1],e[1][1]).length();this.windowRange.AspectScale(a,r.x,1-r.y)}this.renderFrame(),t.preventDefault()})),this.canvas.addEventListener("touchend",(t=>{this.touch_anchors={},t.preventDefault()})),this.canvas.addEventListener("touchcancel",(t=>{this.touch_anchors={},t.preventDefault()}))}panCameraByScreenDelta(t){const e=this.canvasRange.GetPercentage(t.x,t.y);return this.windowRange.ShiftByPercentage(-e.x,e.y),e}renderFrame(){g.os(this.gl,this.program,this.buffer,(t=>{t.uniform1f(t.getUniformLocation(this.program,"MAX_ABSSQ"),this.fractal.MaxAmplitude),t.uniform2fv(t.getUniformLocation(this.program,"window_pos"),[this.windowRange.xRange.min,this.windowRange.yRange.min]),t.uniform2fv(t.getUniformLocation(this.program,"window_size"),[this.windowRange.xRange.Length(),this.windowRange.yRange.Length()])}))}cleanup(){}}function w(t){const e=t.target.getBoundingClientRect();return new x.Z(t.pageX-e.left,t.pageY-e.top)}class _{constructor(t,e,n,r){this.canvas=t,this.colorFunction=n,this.audioPlayer=r,this.mandelbrot=new b(t,e,n,{x:-2,y:-2,w:4,h:4},(t=>{this.playSound(t,e)})),this.mandelbrot.run()}cleanup(){this.mandelbrot.cleanup()}playSound(t,e){this.audioPlayer.Play(new a.Zz(t.x,t.y),e)}}var A=n(4077);const E=[v,m,p,y],C=[o.Z,s.Z,c.Z,l.Z];function R(){const t=r.useRef(),e=r.useRef(),[n,a]=r.useState(v),[o,c]=r.useState(i[0]),[l,u]=r.useState(s.Z);return r.useEffect((()=>{const r=new d(e.current,o),a=new _(t.current,n,l,r);return()=>{a.cleanup(),r.Cleanup()}}),[t,n,o,l]),r.createElement("div",{className:"conway conway_body full_body"},r.createElement("div",{style:{width:"80%",height:"100%",position:"absolute"}},r.createElement("canvas",{ref:t,style:{position:"absolute",width:"100%",height:"100%",top:0,left:0}}),r.createElement("canvas",{ref:e,style:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",top:0,left:0}})),r.createElement("div",{style:{width:"20%",height:"100%",background:"#333",position:"absolute",left:"80%"}},r.createElement("label",null,"Fractal:"),r.createElement(A.f,{options:E,value:n,getName:t=>t.Name,onChange:t=>a(t)}),r.createElement("label",null,"Color:"),r.createElement(A.f,{options:C,value:l,getName:t=>t.Name,onChange:t=>u(t)}),r.createElement("label",null,"Amplitude Function:"),r.createElement(A.f,{options:i,value:o,getName:t=>t.Name,onChange:t=>c(t)}),r.createElement("div",{style:{bottom:0,position:"absolute",color:"#999",textAlign:"center",width:"100%"}},"Inspired by ",r.createElement("a",{href:"https://www.youtube.com/watch?v=GiAj9WW1OfQ"},"this video"))))}}}]);
//# sourceMappingURL=227.bundle.js.map