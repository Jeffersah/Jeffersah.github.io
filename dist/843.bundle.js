"use strict";(self.webpackChunktrading_game=self.webpackChunktrading_game||[]).push([[843],{6718:(t,e,s)=>{s.d(e,{Z:()=>r});class i{constructor(t,e){this.keys=t,this.changes=e}isKeyDown(t){return-1!==this.keys.indexOf(t)}isKeyUp(t){return-1===this.keys.indexOf(t)}}class n{constructor(t,e){this.attachedElement=t,this.logKeyNames=e,void 0===this.logKeyNames&&(this.logKeyNames=!1),t.addEventListener("keydown",(t=>this.onKeyDown(t))),t.addEventListener("keyup",(t=>this.onKeyUp(t))),this.downKeys=[],this.changes=[]}onKeyDown(t){this.logKeyNames&&console.log(t.key),-1===this.downKeys.indexOf(t.key)&&(this.changes.push({key:t.key,change:"press"}),this.downKeys.push(t.key))}onKeyUp(t){this.changes.push({key:t.key,change:"release"});const e=this.downKeys.indexOf(t.key);this.downKeys.splice(e,1)}Update(){const t=this.downKeys,e=this.changes;return this.downKeys=t.slice(),this.changes=[],new i(t,e)}}class r{constructor(t,e){this.watcher=new n(t,e),this.prvState=this.currentState=this.watcher.Update()}update(){this.prvState=this.currentState,this.currentState=this.watcher.Update()}isKeyDown(t){return this.currentState.isKeyDown(t)}isKeyUp(t){return this.currentState.isKeyUp(t)}isKeyPressed(t){return this.currentState.isKeyDown(t)&&this.prvState.isKeyUp(t)}isKeyReleased(t){return this.currentState.isKeyUp(t)&&this.prvState.isKeyDown(t)}changes(){return this.currentState.changes}}},615:(t,e,s)=>{s.d(e,{Nm:()=>i,Dz:()=>h,jR:()=>a});var i,n=s(8785);!function(t){t[t.Up=0]="Up",t[t.UpRight=1]="UpRight",t[t.Right=2]="Right",t[t.DownRight=3]="DownRight",t[t.Down=4]="Down",t[t.DownLeft=5]="DownLeft",t[t.Left=6]="Left",t[t.UpLeft=7]="UpLeft"}(i||(i={}));const r=[new n.Z(0,-1),new n.Z(1,-1),new n.Z(1,0),new n.Z(1,1),new n.Z(0,1),new n.Z(-1,1),new n.Z(-1,0),new n.Z(-1,-1)],h=[i.Up,i.UpRight,i.Right,i.DownRight,i.Down,i.DownLeft,i.Left,i.UpLeft];function a(t){return r[t]}i.Up,i.Right,i.Down,i.Left,i.UpRight,i.DownRight,i.DownLeft,i.UpLeft},8785:(t,e,s)=>{s.d(e,{Z:()=>i});class i{constructor(t,e){this.x=t,this.y=e}static zero(){return new i(0,0)}static fromAngle(t,e){return new i(Math.cos(t)*(null!=e?e:1),Math.sin(t)*(null!=e?e:1))}lengthSq(){return i.dot(this,this)}length(){return Math.sqrt(this.lengthSq())}clone(){return new i(this.x,this.y)}negate(){return new i(-this.x,-this.y)}negateInPlace(){return this.x=-this.x,this.y=-this.y,this}static dot(t,e){return t.x*e.x+t.y*e.y}dotWith(t){return i.dot(this,t)}normalize(){let t=this.length();return i.multiply(this,1/t)}direction(){return Math.atan2(this.y,this.x)}truncate(){return new i(Math.trunc(this.x),Math.trunc(this.y))}addWith(t,e){const{x:s,y:i}=n(t,e);return this.x+=s,this.y+=i,this}multWith(t,e){const{x:s,y:i}=function(t,e){return void 0===e?void 0!==t.x?{x:t.x,y:t.y}:{x:t,y:t}:{x:t,y:e}}(t,e);return this.x*=s,this.y*=i,this}subtractWith(t,e){const{x:s,y:i}=n(t,e);return this.x-=s,this.y-=i,this}divideWith(t,e){const{x:s,y:i}=n(t,e);return this.x/=s,this.y/=i,this}equals(t){return this.x===t.x&&this.y===t.y}static add(t,e,s){const{x:r,y:h}=n(e,s);return new i(t.x+r,t.y+h)}static subtract(t,e,s){const{x:r,y:h}=n(e,s);return new i(t.x-r,t.y-h)}static multiply(t,e,s){return void 0!==s?new i(t.x*e,t.y*s):void 0!==e.x?new i(t.x*e.x,t.y*e.y):new i(t.x*e,t.y*e)}static interpolate(t,e,s){return new i(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s)}static componentMin(t,e){return t.x<=e.x&&t.y<=e.y?t:e.x<=t.x&&e.y<=t.y?e:new i(Math.min(t.x,e.x),Math.min(t.y,e.y))}static componentMax(t,e){return t.x>=e.x&&t.y>=e.y?t:e.x>=t.x&&e.y>=t.y?e:new i(Math.max(t.x,e.x),Math.max(t.y,e.y))}static Bezier(t,e){return 1===t.length?t[0]:2===t.length?i.add(i.multiply(t[1],e),i.multiply(t[0],1-e)):i.add(i.multiply(i.Bezier(t.slice(1),e),e),i.multiply(i.Bezier(t.slice(0,t.length-1),e),1-e))}rotate(t){const e=Math.atan2(this.y,this.x),s=this.length();return i.fromAngle(e+t,s)}}function n(t,e){return void 0===e?{x:t.x,y:t.y}:{x:t,y:e}}},5907:(t,e,s)=>{s.d(e,{Z:()=>r});var i=s(8785),n=s(615);class r{constructor(t,e,s,i){this.x=t,this.y=e,this.w=s,this.h=i}shift(t,e){return void 0===e?new r(this.x+t.x,this.y+t.y,this.w,this.h):new r(this.x+t,this.y+e,this.w,this.h)}shiftBy(t,e){void 0===e?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=e)}edge(t){switch(t){case n.Nm.Up:return this.y;case n.Nm.Down:return this.y+this.h;case n.Nm.Left:return this.x;case n.Nm.Right:return this.x+this.w}}corner(t){switch(t){case n.Nm.UpRight:case n.Nm.DownRight:case n.Nm.DownLeft:case n.Nm.UpLeft:return new i.Z(this.x,this.y)}}equals(t){return t.x===this.x&&t.y===this.y&&t.w===this.w&&t.h===this.h}}},725:(t,e,s)=>{s.r(e),s.d(e,{default:()=>q});var i=s(3804),n=s(127),r=s(5901),h=s(7604),a=s(6718),o=s(8785);const c=32,l=32,w=new o.Z(16,24),u=352,d=new o.Z(160,160),y=new o.Z(-2,4);var g=s(3486);const p=s.p+"1bece4b53ae0cc7f1c101b72c3505480.png";class x{constructor(t){this.tiles=new g.V(32,32,p,t.registerAssetLoadCallback())}}var m,f=s(5907);class Z{constructor(t,e,s){this.source=t,this.sourceBounds=e,this.origin=null!=s?s:new o.Z(0,0)}getSprite(){return this}getPixelSize(){return new o.Z(this.sourceBounds.w,this.sourceBounds.h)}getRenderable(){return this}width(){return this.sourceBounds.w}height(){return this.sourceBounds.h}tick(){return!1}draw(t,e,s){const i=t.getTransform();(0,r.ei)(t,e.x,e.y,this.origin.x,this.origin.y,s),t.drawImage(this.source,this.sourceBounds.x,this.sourceBounds.y,this.sourceBounds.w,this.sourceBounds.h,0,0,e.w,e.h),t.setTransform(i)}}class R{constructor(t,e,s){this.type=t,"primary"===this.type?(this.sprite=new Z(e.tiles.image,new f.Z(s.x*c,s.y*l,16,l)),this.iconImage=new Z(e.tiles.image,new f.Z(s.x*c+16,s.y*l,16,l))):(this.sprite=new Z(e.tiles.image,new f.Z(s.x*c+16,s.y*l,16,l)),this.iconImage=new Z(e.tiles.image,new f.Z(s.x*c,s.y*l,16,l)))}}!function(t){t[t.Right=0]="Right",t[t.DownRight=1]="DownRight",t[t.DownLeft=2]="DownLeft",t[t.Left=3]="Left",t[t.UpLeft=4]="UpLeft",t[t.UpRight=5]="UpRight"}(m||(m={}));const L=[m.Right,m.DownRight,m.DownLeft,m.Left,m.UpLeft,m.UpRight];class b{static ToPoint(t){switch(t){case m.Right:return new o.Z(1,0);case m.DownRight:return new o.Z(0,1);case m.DownLeft:return new o.Z(-1,1);case m.Left:return new o.Z(-1,0);case m.UpLeft:return new o.Z(0,-1);case m.UpRight:return new o.Z(1,-1)}}static Turn(t,e){return((t+e)%6+6)%6}}function D(t){return o.Z.add(o.Z.multiply(w,t.y),32*t.x+d.x,d.y)}function U(t){if(0===t)return[new o.Z(0,0)];const e=[];let s=new o.Z(0,-t);for(var i=m.Right;i<=m.UpRight;i++)for(var n=b.ToPoint(i),r=0;r<t;r++)e.push(s),s=o.Z.add(s,n);return e}class S extends class{constructor(t){this.position=t}TakeDamage(t){}tick(t){}}{constructor(t,e){super(e),this.primary=new R("primary",t,new o.Z(8,1)),this.secondary=new R("secondary",t,new o.Z(10,0)),this.renderable=new Z(t.tiles.image,new f.Z(256,0,c,l))}draw(t){const e=D(this.position),s=new f.Z(e.x,e.y,c,l);this.renderable.draw(t,s,0),this.primary.sprite.draw(t,new f.Z(s.x,s.y,s.w/2,s.h),0),this.secondary.sprite.draw(t,new f.Z(s.x+s.w/2,s.y,s.w/2,s.h),0)}}class k{constructor(t,e){this._size=t,this.data=[];let s=2*t-1;for(let i=1-t;i<=t-1;i++){let t=[];for(let n=0;n<s-Math.abs(i);n++)t.push(e);this.data.push(t)}}size(){return this._size}get(t,e){const[s,i]=this.extractInputCoords(t,e);let[n,r]=this.toArrayCoords(s,i);return this.data[r][n]}set(t,e,s){const[i,n]=this.extractInputCoords(e,s),[r,h]=this.toArrayCoords(i,n);this.data[h][r]=t}extractInputCoords(t,e){return"number"==typeof t?[t,e]:void 0!==t.x?[t.x,t.y]:t}getRowLength(t){return 2*this._size-1-Math.abs(t)}isInBounds(t,e){if(e<=-this._size||e>=this._size)return!1;let[s,i]=this.getXRange(e);return t>=s&&t<i}getXRange(t){const e=this.getMinX(t);return[e,e+this.getRowLength(t)]}getMinX(t){const e=this._size-1+t;return-Math.min(e,this._size-1)}iterate(t){for(let e=1-this._size;e<this._size;e++){let[s,i]=this.getXRange(e);for(let n=s;n<i;n++)t(n,e,this.get(n,e))}}toArrayCoords(t,e){const s=this._size-1+e;return[t- -Math.min(s,this._size-1),s]}}class v{constructor(t,e,s,i){this.assets=t,this.entities=new k(e,null),this.changeFloor(s,i),this.player=new S(t,y),this.entities.set(this.player,y.x,y.y)}changeFloor(t,e){this.entities=new k(this.entities.size(),null),e.generateMap(this.assets,t,this),this.tiles.iterate(((t,e,s)=>{s.AfterWorldLoad(this,new o.Z(t,e))}))}draw(t){this.tiles.iterate(((e,s,i)=>{i.draw(t,this,new o.Z(e,s))})),this.entities.iterate(((e,s,i)=>{null!=i&&i.draw(t)}))}}class K{tick(t){return this}draw(t,e){e.draw(t)}}class M{constructor(){this.animationTime=0}tick(t){return this.animationTime++,this.animationTime>=120?new K:this}draw(t,e){e.draw(t),t.fillStyle="#000000",this.animationTime<=120&&(t.globalAlpha=1-this.animationTime/120,t.fillRect(0,0,u,u),t.globalAlpha=1),e.player.draw(t)}}class C{constructor(){this.animationTime=0}tick(t){return this.animationTime++,this.animationTime>=120?new M:this}draw(t,e){e.player.draw(t),t.fillStyle="#000000",this.animationTime<=120&&(t.globalAlpha=1-this.animationTime/120,t.fillRect(0,0,u,u),t.globalAlpha=1)}}class z{constructor(t,e){this.typeId=t,this.isPathable=e}}class _ extends z{constructor(t,e,s,i){super(t,i),this.bg_renderable=new Z(e.tiles.image,new f.Z(352,0,c,l)),this.renderable=new Z(e.tiles.image,new f.Z(s.x*c,s.y*l,c,l))}AfterWorldLoad(t,e){}draw(t,e,s){let i=D(s);this.bg_renderable.draw(t,new f.Z(i.x,i.y+24,c,l),0),this.renderable.draw(t,new f.Z(i.x,i.y,c,l),0)}}class T extends _{constructor(t){super(0,t,new o.Z(0,0),!0)}OnEntityStep(t){}}class B extends _{constructor(t){super(2,t,new o.Z(5,0),!0)}OnEntityStep(t){}}class A{constructor(t,e){this.renderables=t,this.finishMode=null!=e?e:"any"}tick(){let t=!0,e=!1;for(let s=0;s<this.renderables.length;s++){const i=this.renderables[s].tick();t=t&&i,e=e||i}return"any"===this.finishMode?e:t}draw(t,e,s){for(let i=0;i<this.renderables.length;i++)this.renderables[i].draw(t,e,s)}}class N{constructor(t,e){this.source=t,this.delta=e}tick(){return this.source.tick()}draw(t,e,s){this.source.draw(t,new f.Z(e.x+this.delta.x*e.w,e.y+this.delta.y*e.h,e.w*this.delta.w,e.h*this.delta.h),s)}}const I=[{directions:[m.UpLeft,m.UpRight],tileCoords:new o.Z(0,0),tileSlice:new f.Z(0,0,1,.5)},{directions:[m.DownLeft,m.DownRight],tileCoords:new o.Z(0,0),tileSlice:new f.Z(0,.5,1,.5)},{directions:[m.Left,m.UpLeft],tileCoords:new o.Z(0,1),tileSlice:new f.Z(0,0,.5,.5)},{directions:[m.Right,m.UpRight],tileCoords:new o.Z(0,1),tileSlice:new f.Z(.5,0,.5,.5)},{directions:[m.Left,m.DownLeft],tileCoords:new o.Z(0,1),tileSlice:new f.Z(0,.5,.5,.5)},{directions:[m.Right,m.DownRight],tileCoords:new o.Z(0,1),tileSlice:new f.Z(.5,.5,.5,.5)}];class E extends z{constructor(t,e,s,i){super(t,i),this.spriteSheetPosition=s,this.assets=e,this.bg_renderable=new Z(e.tiles.image,new f.Z(352,0,c,l))}AfterWorldLoad(t,e){const s=L.map((s=>{const i=o.Z.add(e,b.ToPoint(s));return!t.tiles.isInBounds(i.x,i.y)||t.tiles.get(e).typeId!==t.tiles.get(i).typeId})),i=I.map((t=>{const e=t.directions.reduceRight(((t,e)=>(t<<1)+(s[e]?1:0)),0),i=new f.Z((t.tileCoords.x+e+t.tileSlice.x+this.spriteSheetPosition.x)*c,(t.tileCoords.y+t.tileSlice.y+this.spriteSheetPosition.y)*l,t.tileSlice.w*c,t.tileSlice.h*l);return new N(new Z(this.assets.tiles.image,i),t.tileSlice)}));this.renderable=new A(i,"all")}draw(t,e,s){let i=D(s);this.bg_renderable.draw(t,new f.Z(i.x,i.y+24,c,l),0),this.renderable.draw(t,new f.Z(i.x,i.y,c,l),0)}}class P extends E{constructor(t){super(1,t,new o.Z(0,4),!1)}OnEntityStep(t){t.isFlying||t.TakeDamage(999)}}class W{generateMap(t,e,s){s.tiles=new k(6,new T(t));const i=U(2);for(var n=0;n<i.length;n++)s.tiles.set(new P(t),i[n]);const r=U(3);for(n=0;n<r.length;n+=3)s.tiles.set(new P(t),r[n]);s.tiles.set(new P(t),0,0),s.tiles.set(new B(t),2,-4)}}function O(){let t,e,s;const i=new n.Z,o=new x(i);let c,l=new C;function w(){l=l.tick(c),t.clearRect(0,0,u,u),t.fillStyle="#000000",t.fillRect(0,0,u,u),l.draw(t,c),requestAnimationFrame((()=>w()))}return e=new a.Z(document.body),i.onAllFinished((function(){const e=document.getElementById("mainCanvas");t=e.getContext("2d"),s=new h.Z(e,t,u,u,!0,(()=>{})),c=new v(o,6,0,new W),(0,r.Ci)(t),w()})),()=>s.Detatch()}function q(){return i.useEffect((()=>O())),i.createElement("div",{className:"rpgt rpgt_body full_body center"},i.createElement("canvas",{id:"mainCanvas"}))}}}]);
//# sourceMappingURL=843.bundle.js.map