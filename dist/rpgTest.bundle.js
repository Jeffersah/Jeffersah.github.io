(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{64:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{constructor(t,e){this.x=t,this.y=e}LengthSq(){return s.Dot(this,this)}Length(){return Math.sqrt(this.LengthSq())}Clone(){return new s(this.x,this.y)}Negate(){return new s(-this.x,-this.y)}NegateInPlace(){return this.x=-this.x,this.y=-this.y,this}static Dot(t,e){return t.x*e.x+t.y*e.y}DotWith(t){return s.Dot(this,t)}Direction(){return Math.atan2(this.y,this.x)}AddWith(t,e){const i=void 0===e?t.x:t,s=void 0===e?t.y:e;return this.x+=i,this.y+=s,this}MultWith(t,e){const i=void 0===e?t.x:t,s=void 0===e?t.y:e;return this.x*=i,this.y*=s,this}SubtractWith(t,e){const i=void 0===e?t.x:t,s=void 0===e?t.y:e;return this.x-=i,this.y-=s,this}DivideWith(t,e){const i=void 0===e?t.x:t,s=void 0===e?t.y:e;return this.x/=i,this.y/=s,this}Equals(t){return this.x===t.x&&this.y===t.y}static Add(t,e){return new s(t.x+e.x,t.y+e.y)}static Multiply(t,e,i){return void 0!==i?new s(t.x*e,t.y*i):void 0!==e.x?new s(t.x*e.x,t.y*e.y):new s(t.x*e,t.y*e)}}},66:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return r})),i.d(e,"b",(function(){return a}));var s,n=i(64);!function(t){t[t.Up=0]="Up",t[t.UpRight=1]="UpRight",t[t.Right=2]="Right",t[t.DownRight=3]="DownRight",t[t.Down=4]="Down",t[t.DownLeft=5]="DownLeft",t[t.Left=6]="Left",t[t.UpLeft=7]="UpLeft"}(s||(s={}));const h=[new n.a(0,-1),new n.a(1,-1),new n.a(1,0),new n.a(1,1),new n.a(0,1),new n.a(-1,1),new n.a(-1,0),new n.a(-1,-1)],r=[s.Up,s.UpRight,s.Right,s.DownRight,s.Down,s.DownLeft,s.Left,s.UpLeft];s.Up,s.Right,s.Down,s.Left,s.UpRight,s.DownRight,s.DownLeft,s.UpLeft;function a(t){return h[t]}},68:function(t,e,i){"use strict";e.a=i.p+"bbb298f00b41bbd627d27aa0529a20ba.png"},78:function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return m}));var s=i(16),n=i(17),h=i(68),r=i.p+"42ace1eb95edbc899165c10bb9cc20ab.png",a=i.p+"e5352b303b79e08de36a8c4248cdbb28.png",o=i(7),c=i(20),l=i(66);function d(t,e,i){let s=!1;const n={break:()=>{s=!0}};if(e===t)return void i(t,n);const h=e>t?1:-1,r=e+h;for(let e=t;e!==r&&!s;e+=h)i(e,n)}class w{constructor(t,e,i){this.width=t,this.height=e,this.cells=[];for(let s=0;s<t;s++){const t=[];for(let s=0;s<e;s++)t.push(i());this.cells.push(t)}this.prerender=document.getElementById("world_prerender")}updatePrerender(){Object(o.b)(this.prerender,16*this.width,16*this.height);const t=this.prerender.getContext("2d");for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.cells[e][i].paint(t,16*e,16*i)}tryMoveEntity(t,e,i){const s=e.x>=0?l.a.Right:l.a.Left,n=e.y>=0?l.a.Down:l.a.Up;if(0!==e.x){const n=Math.floor(t.Edge(s)/16),h=Math.floor((t.Edge(s)+e.x)/16),r=Math.floor(t.Edge(l.a.Up)/16),a=Math.floor((t.Edge(l.a.Down)-1)/16);let o;d(n,h,(t,e)=>{for(let s=r;s<=a;s++){if(t<0||t>=this.width)return o=t,void e.break();i&&i(t,s),this.cells[t][s].pathable||(e.break(),o=t)}}),void 0===o?t.x+=e.x:e.x>=0?t.x=16*o-t.w:t.x=16*(o+1)}if(0!==e.y){const s=Math.floor(t.Edge(n)/16),h=Math.floor((t.Edge(n)+e.y)/16),r=Math.floor(t.Edge(l.a.Left)/16),a=Math.floor((t.Edge(l.a.Right)-1)/16);let o;d(s,h,(t,e)=>{for(let s=r;s<=a;s++){if(t<0||t>=this.height)return o=t,void e.break();i&&i(s,t),this.cells[s][t].pathable||(e.break(),o=t)}}),void 0===o?t.y+=e.y:e.y>=0?t.y=16*o-t.h:t.y=16*(o+1)}}}class u{constructor(t,e,i){this.sheet=t,this.tileX=e,this.tileY=i,this.width=t.spriteWidth,this.height=t.spriteHeight}paint(t,e,i,s,n){this.sheet.render(t,e,i,s,n,this.tileX,this.tileY)}}const y=[[10,0],[10,0],[10,0],[10,0],[10,0],[7,1],[7,1],[10,1],[10,2],[9,2]];class f{constructor(t,e){this.pathable=t,this.graphic=e}paint(t,e,i){this.graphic.paint(t,e,i,16,16)}static GrassFloor(t){const e=y[Math.floor(Math.random()*y.length)];return new f(!0,new u(t,e[0],e[1]))}static RockWall(t){return new f(!1,new u(t,7,24))}}var g=i(64);class x{constructor(t,e,i,s){this.x=t,this.y=e,this.w=i,this.h=s}Shift(t,e){return void 0===e?new x(this.x+t.x,this.y+t.y,this.w,this.h):new x(this.x+t,this.y+e,this.w,this.h)}ShiftBy(t,e){void 0===e?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=e)}Edge(t){switch(t){case l.a.Up:return this.y;case l.a.Down:return this.y+this.h;case l.a.Left:return this.x;case l.a.Right:return this.x+this.w}}Corner(t){switch(t){case l.a.UpRight:case l.a.DownRight:case l.a.DownLeft:case l.a.UpLeft:return new g.a(this.x,this.y)}}equals(t){return t.x===this.x&&t.y===this.y&&t.w===this.w&&t.h===this.h}}var p=i(21),b=i(11),D=i.n(b);class v{constructor(t,e){this.onload=e,D.a.get(t).subscribe(t=>{this.body=t.data,this.onload()})}}let L,R,M,U;function m(){const t=new s.a;L={tiles:new n.a(16,16,r,t.registerAssetLoadCallback()),wizard:new n.a(16,16,a,t.registerAssetLoadCallback()),arrows:new n.a(16,16,h.a,t.registerAssetLoadCallback()),tilesets:new v("../dist/assets/rpgtest/tilesets.json",t.registerAssetLoadCallback())},U=new p.a(document.body),t.onAllFinished(E)}function E(){M=new w(56,56,()=>Math.random()<=.15?f.RockWall(L.tiles):f.GrassFloor(L.tiles)),M.updatePrerender();const t=document.getElementById("mainCanvas");R=t.getContext("2d");new c.a(t,R,448,448,!0,()=>{});!function t(){R.clearRect(0,0,448,448),Object(o.a)(R),R.save();let e=0,i=0;M.width>28&&(e=Math.max(0,Math.min(16*(M.width-28),A.x-224)));M.height>28&&(i=Math.max(0,Math.min(16*(M.height-28),A.y-224)));k.MultWith(3,3).AddWith(e,i).DivideWith(4,4),R.translate(-k.x,-k.y),R.drawImage(M.prerender,0,0),U.update(),R.fillStyle="blue",R.fillRect(A.x,A.y,A.w,A.h);const s=new g.a(0,0);U.isKeyDown("a")&&(s.x=-3);U.isKeyDown("d")&&(s.x=3);U.isKeyDown("w")&&(s.y=-3);U.isKeyDown("s")&&(s.y=3);R.fillStyle="yellow",R.globalAlpha=.6,M.tryMoveEntity(A,s,(t,e)=>{R.fillRect(16*t,16*e,16,16)}),R.globalAlpha=1,W=!W,W&&(R.fillStyle="white",R.fillRect(0,0,10,10));R.restore(),requestAnimationFrame(()=>t())}()}const k=new g.a(0,0),A=new x(0,0,14,14);let W=!1}}]);
//# sourceMappingURL=rpgTest.bundle.js.map