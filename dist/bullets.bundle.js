(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{73:function(t,i,e){"use strict";e.d(i,"a",(function(){return s}));class s{constructor(t,i){this.x=t,this.y=i}static fromAngle(t,i){return new s(Math.cos(t)*(null!=i?i:1),Math.sin(t)*(null!=i?i:1))}LengthSq(){return s.Dot(this,this)}Length(){return Math.sqrt(this.LengthSq())}Clone(){return new s(this.x,this.y)}Negate(){return new s(-this.x,-this.y)}NegateInPlace(){return this.x=-this.x,this.y=-this.y,this}static Dot(t,i){return t.x*i.x+t.y*i.y}DotWith(t){return s.Dot(this,t)}normalize(){let t=this.Length();return s.Multiply(this,1/t)}Direction(){return Math.atan2(this.y,this.x)}AddWith(t,i){const{x:e,y:s}=n(t,i);return this.x+=e,this.y+=s,this}MultWith(t,i){const{x:e,y:s}=n(t,i);return this.x*=e,this.y*=s,this}SubtractWith(t,i){const{x:e,y:s}=n(t,i);return this.x-=e,this.y-=s,this}DivideWith(t,i){const{x:e,y:s}=n(t,i);return this.x/=e,this.y/=s,this}Equals(t){return this.x===t.x&&this.y===t.y}static add(t,i,e){const{x:r,y:a}=n(i,e);return new s(t.x+r,t.y+a)}static subtract(t,i,e){const{x:r,y:a}=n(i,e);return new s(t.x-r,t.y-a)}static Multiply(t,i,e){return void 0!==e?new s(t.x*i,t.y*e):void 0!==i.x?new s(t.x*i.x,t.y*i.y):new s(t.x*i,t.y*i)}static interpolate(t,i,e){return new s(t.x+(i.x-t.x)*e,t.y+(i.y-t.y)*e)}static componentMin(t,i){return t.x<=i.x&&t.y<=i.y?t:i.x<=t.x&&i.y<=t.y?i:new s(Math.min(t.x,i.x),Math.min(t.y,i.y))}static componentMax(t,i){return t.x>=i.x&&t.y>=i.y?t:i.x>=t.x&&i.y>=t.y?i:new s(Math.max(t.x,i.x),Math.max(t.y,i.y))}rotate(t){const i=Math.atan2(this.y,this.x),e=this.Length();return s.fromAngle(i+t,e)}}function n(t,i){return void 0===i?{x:t.x,y:t.y}:{x:t,y:i}}},75:function(t,i,e){"use strict";e.d(i,"a",(function(){return s}));class s{constructor(t){t.h||t.s||t.v?(this.hsv=t,this.rgb=void 0):(this.rgb=t,this.hsv=void 0)}static rgb(t,i,e){return new s({r:t,g:i,b:e})}static hsv(t,i,e){return new s({h:t,s:i,v:e})}r(t){if(this.reqRgb(),void 0===t)return this.rgb.r;this.rgb.r=t,this.hsv=void 0}g(t){if(this.reqRgb(),void 0===t)return this.rgb.g;this.rgb.g=t,this.hsv=void 0}b(t){if(this.reqRgb(),void 0===t)return this.rgb.b;this.rgb.b=t,this.hsv=void 0}h(t){if(this.reqHsv(),void 0===t)return this.hsv.h;this.hsv.h=t,this.hsv=void 0}s(t){if(this.reqHsv(),void 0===t)return this.hsv.s;this.hsv.s=t,this.hsv=void 0}v(t){if(this.reqHsv(),void 0===t)return this.hsv.v;this.hsv.v=t,this.hsv=void 0}componentToRgb(t){const i=(t+6*this.hsv.h)%6;return this.hsv.v-this.hsv.v*this.hsv.s*Math.max(Math.min(i,4-i,1),0)}reqRgb(){void 0===this.rgb&&this.calcRgb()}calcRgb(){this.rgb={r:this.componentToRgb(5),g:this.componentToRgb(3),b:this.componentToRgb(1)}}reqHsv(){void 0===this.hsv&&this.calcHsv()}calcHsv(){const{r:t,g:i,b:e}=this.rgb,s=Math.max(t,i,e),n=Math.min(t,i,e);let r=s===n?0:s===t?(i-e)/(s-n):s===i?2+(e-t)/(s-n):4+(t-i)/(s-n);for(r/=6;r<0;)r++;this.hsv={h:r,s:s===n?0:(s-n)/s,v:s}}toString(){return this.reqRgb(),"rgb("+this.toByte(this.rgb.r)+", "+this.toByte(this.rgb.g)+", "+this.toByte(this.rgb.b)+")"}toByte(t){return Math.floor(255*t)}}},78:function(t,i,e){"use strict";e.d(i,"a",(function(){return r}));class s{constructor(t,i){this.keys=t,this.changes=i}isKeyDown(t){return-1!==this.keys.indexOf(t)}isKeyUp(t){return-1===this.keys.indexOf(t)}}class n{constructor(t,i){this.attachedElement=t,this.logKeyNames=i,void 0===this.logKeyNames&&(this.logKeyNames=!1),t.addEventListener("keydown",t=>this.onKeyDown(t)),t.addEventListener("keyup",t=>this.onKeyUp(t)),this.downKeys=[],this.changes=[]}onKeyDown(t){this.logKeyNames&&console.log(t.key);-1===this.downKeys.indexOf(t.key)&&(this.changes.push({key:t.key,change:"press"}),this.downKeys.push(t.key))}onKeyUp(t){this.changes.push({key:t.key,change:"release"});const i=this.downKeys.indexOf(t.key);this.downKeys.splice(i,1)}Update(){const t=this.downKeys,i=this.changes;return this.downKeys=t.slice(),this.changes=[],new s(t,i)}}class r{constructor(t,i){this.watcher=new n(t,i),this.prvState=this.currentState=this.watcher.Update()}update(){this.prvState=this.currentState,this.currentState=this.watcher.Update()}isKeyDown(t){return this.currentState.isKeyDown(t)}isKeyUp(t){return this.currentState.isKeyUp(t)}isKeyPressed(t){return this.currentState.isKeyDown(t)&&this.prvState.isKeyUp(t)}isKeyReleased(t){return this.currentState.isKeyUp(t)&&this.prvState.isKeyDown(t)}changes(){return this.currentState.changes}}},84:function(t){t.exports=JSON.parse('[{"name":"red_interceptor","size":[16,16],"imgOffset":[64,32],"origin":[0.25,0.5],"hp":5,"maxAccel":0.1,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.05,"flares":[{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[0,8],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[10,4],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[10,12],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"blue_interceptor","size":[16,16],"imgOffset":[64,128],"origin":[0.25,0.5],"hp":5,"maxAccel":0.1,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.05,"flares":[{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[0,3],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[0,13],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8}],"ai":"fighter"},{"name":"red_fighter","size":[32,32],"imgOffset":[64,64],"origin":[0.25,0.5],"hp":5,"maxAccel":0.1,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.05,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,16],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[24,11],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[24,22],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"blue_fighter","size":[32,32],"imgOffset":[64,160],"origin":[0.25,0.5],"hp":5,"maxAccel":0.1,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.05,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,16],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[24,11],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[24,22],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"red_small_cruiser","size":[48,32],"imgOffset":[48,0],"origin":[0.25,0.5],"hp":5,"maxAccel":0.08,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.03,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,12],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,21],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,8],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,25],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"blue_small_cruiser","size":[48,32],"imgOffset":[48,96],"origin":[0.25,0.5],"hp":5,"maxAccel":0.08,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.03,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,12],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,21],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,8],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,25],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"red_small_missile_cruiser","size":[48,32],"imgOffset":[0,0],"origin":[0.25,0.5],"hp":5,"maxAccel":0.08,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.03,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,12],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,21],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,8],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,25],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"blue_small_missile_cruiser","size":[48,32],"imgOffset":[0,96],"origin":[0.25,0.5],"hp":5,"maxAccel":0.08,"maxDeccel":0.01,"maxSpeed":3,"turnAccel":0.001,"maxTurnSpeed":0.03,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,12],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,21],"rotation":3.141,"condition":["accel","turnLeft","turnRight"],"rotPerTurn":-0.8},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,8],"rotation":4.712,"condition":"turnRight","minTrigger":0.1},{"animation":{"imgOffset":[0,0],"frameSize":[8,4],"numFrames":6,"origin":[0,0.5]},"offset":[31,25],"rotation":1.57,"condition":"turnLeft","minTrigger":0.1}],"ai":"fighter"},{"name":"red_cargo","size":[64,48],"imgOffset":[0,32],"origin":[0.25,0.5],"hp":5,"maxAccel":0.04,"maxDeccel":0.01,"maxSpeed":2,"turnAccel":0.001,"maxTurnSpeed":0.01,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,14],"rotation":3.141,"condition":["accel","turnRight"]},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,20],"rotation":3.141,"condition":["accel","turnRight"]},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,28],"rotation":3.141,"condition":["accel","turnLeft"]},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,34],"rotation":3.141,"condition":["accel","turnLeft"]}],"ai":"fighter"},{"name":"blue_cargo","size":[64,48],"imgOffset":[0,128],"origin":[0.25,0.5],"hp":5,"maxAccel":0.04,"maxDeccel":0.01,"maxSpeed":2,"turnAccel":0.001,"maxTurnSpeed":0.01,"flares":[{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,14],"rotation":3.141,"condition":["accel","turnRight"]},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,20],"rotation":3.141,"condition":["accel","turnRight"]},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,28],"rotation":3.141,"condition":["accel","turnLeft"]},{"animation":{"imgOffset":[0,16],"frameSize":[16,8],"numFrames":8,"origin":[0,0.5]},"offset":[0,34],"rotation":3.141,"condition":["accel","turnLeft"]}],"ai":"fighter"}]')},87:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return ot}));var s=e(24),n=1e3,r=800,a=e(26),o=e(13),h=e(25),c=e.p+"12a4e8650485f6c9e051cf30dfcfc746.png",l=e.p+"099f5ee348a27002555007bd55523f94.png",u=e.p+"4491ebbcec40a56c8cb02c9b36b8f12a.png",m=e(73);const f=2*Math.PI;class g{static normalize(t){return(t%=f)<0&&(t+=f),t}static relativeNormalize(t){return(t%=f)>Math.PI?t-=f:t<-Math.PI&&(t+=f),t}static relativeAngle(t,i){return g.relativeNormalize(t-i)}}const d=.2,y=20,p=.998,x=.99,w=.06,v=.002,S=.004,b=.98,M=.003,T=120;class z{constructor(t){this.sprites=t,this.position=new m.a(0,0),this.velocity=new m.a(0,0),this.angularVelocity=0,this.rotation=0,this.engineDeflect=0,this.tgtDeflect=0}tick(t){t.isKeyDown("w")?this.isEngineOn=!0:this.isEngineOn=!1,t.isKeyDown("a")?this.tgtDeflect=1:t.isKeyDown("d")?this.tgtDeflect=-1:this.tgtDeflect=0,this.tgtDeflect>=this.engineDeflect?this.engineDeflect=Math.min(this.engineDeflect+w,this.tgtDeflect):this.engineDeflect=Math.max(this.engineDeflect-w,this.tgtDeflect);const i=Math.atan2(this.velocity.y,this.velocity.x),e=g.relativeAngle(this.rotation,i),s=e/Math.PI;this.angularVelocity*=b,this.angularVelocity-=this.tgtDeflect*v+this.engineDeflect*S*(this.isEngineOn?1:0),this.rotation+=this.angularVelocity;const n=(1-Math.abs(s))*p+Math.abs(s)*x;this.velocity.MultWith(n,n),this.isEngineOn&&(this.velocity.x+=d*Math.cos(this.rotation),this.velocity.y+=d*Math.sin(this.rotation));let r=this.velocity.Length(),a=this.velocity.Direction();r>=y&&(r=y);let o=Math.sin(e);o*=Math.min(r/T,1),o*=M,a+=o,this.velocity.x=Math.cos(a)*r,this.velocity.y=Math.sin(a)*r,this.position.AddWith(this.velocity)}render(t){t.save(),Object(o.c)(t,this.position.x,this.position.y,4,8,this.rotation+Math.PI/2),this.isEngineOn&&this.sprites.rotrender(t,4,11,8,16,Math.floor(4*Math.random()),1,this.engineDeflect*Math.PI/4,4,2),this.tgtDeflect>0?this.sprites.rotrender(t,7,4,8,16,Math.floor(2*Math.random()),2,0,3,4):this.tgtDeflect<0&&this.sprites.rotrender(t,1,4,8,16,2+Math.floor(2*Math.random()),2,0,6,4),this.sprites.render(t,0,0,8,16,0,0),t.restore()}}var O,R=e(78);!function(t){t[t.ally=0]="ally",t[t.enemy=1]="enemy",t[t.neutral=2]="neutral"}(O||(O={}));class A{constructor(t,i){this.keys=i,this.Player=t,this.Entities={},this.Entities[O.neutral]=[],this.Entities[O.ally]=[],this.Entities[O.enemy]=[],this.Effects=[]}tick(){this.keys.update();for(let t=this.Effects.length-1;t>=0;t--)this.Effects[t].tick()&&this.Effects.splice(t,1);this.updateEntities(this.Entities[O.neutral]),this.updateEntities(this.Entities[O.ally]),this.updateEntities(this.Entities[O.enemy])}updateEntities(t){for(let i=t.length-1;i>=0;i--)t[i].tick(this.keys,this)||t.splice(i,1)}draw(t){this.drawEntities(t,this.Entities[O.neutral]),this.drawEntities(t,this.Entities[O.ally]),this.drawEntities(t,this.Entities[O.enemy]);for(let i=0;i<this.Effects.length;i++)this.Effects[i].draw(t)}drawEntities(t,i){for(let e=i.length-1;e>=0;e--)i[e].render(t)}}class D{constructor(t,i){this.range=t,this.timingFunction=i}}class k{constructor(t){this.totalTime=t,this.elapsedTime=0}tick(){return this.elapsedTime++,this.elapsedTime>=this.totalTime}sample(t){return t.range.sample(t.timingFunction(this.elapsedTime/this.totalTime))}}class E{constructor(t,i,e,s,n){this.position=t,this.outerRadius=i,this.innerRadius=e,this.fillColor=s,this.timing=new k(n)}tick(){return this.timing.tick()}draw(t){const i=this.timing.sample(this.outerRadius),e=this.timing.sample(this.innerRadius),s=this.timing.sample(this.fillColor);t.beginPath(),t.arc(this.position.x,this.position.y,i,0,2*Math.PI,!1),e>=0&&t.arc(this.position.x,this.position.y,e,0,2*Math.PI,!0),t.closePath(),t.fillStyle=s.toString(),t.fill()}}const F={linear:t=>t,clamp:t=>Math.max(Math.min(t,1),0),fastIn:L(0,.8,1),fastOut:L(0,.2,1)};function L(...t){return i=>function t(i,e,s,n){return 1===n?e[s]:t(i,e,s,n-1)*(1-i)+t(i,e,s+1,n-1)*i}(i,t,0,t.length)}var P=e(75);const K=(t,i,e)=>t+(i-t)*e,I=(t,i,e)=>P.a.rgb(K(t.r(),i.r(),e),K(t.g(),i.g(),e),K(t.b(),i.b(),e));function V(t,...i){void 0===t.arguments&&(i.splice(0,0,t),t=void 0);let e=1/(i.length-1),s=new B(i[0],t);for(let t=1;t<i.length;t++)s.addKeyFrame(e*t,i[t]);return s}class B{constructor(t,i){if(void 0===i)if("number"==typeof t)this.interpolator=K;else{if(void 0===t.r)throw"No default interpolator found";this.interpolator=I}else this.interpolator=i;this.keys=[{time:0,value:t}]}addKeyFrame(t,i){for(let e=0;e<this.keys.length;e++)if(t<this.keys[e].time)return void this.keys.splice(e,0,{time:t,value:i});this.keys.push({time:t,value:i})}sample(t){if(1===this.keys.length)return this.keys[0].value;for(var i=0;this.keys[i+1].time<t&&i+2<this.keys.length;)i++;let e=this.keys[i+1].time-this.keys[i].time,s=(t-this.keys[i].time)/e;return this.interpolator(this.keys[i].value,this.keys[i+1].value,s)}}class _{constructor(t,i,e,s,n,r,a){this.position=t,this.burstXVariance=i,this.burstYVariance=e,this.numBursts=s,this.burstDelay=n,this.burstLifetime=r,this.burstOuterRadius=a,this.currentBurstDelay=0,this.maxExplosionIndex=0;const o=Math.floor(s.GetValue(Math.random()));this.explosions=new Array(o),this.triggerExplosions()}triggerExplosions(){for(;0===this.currentBurstDelay&&this.maxExplosionIndex<this.explosions.length;)this.currentBurstDelay=this.burstDelay,this.spawnBurst()}spawnBurst(){const t=this.position.x+this.burstXVariance.GetValue(Math.random()),i=this.position.y+this.burstYVariance.GetValue(Math.random()),e=this.burstLifetime.GetValue(Math.random()),s=this.burstOuterRadius.GetValue(Math.random()),n=s/4;this.explosions[this.maxExplosionIndex++]=new E(new m.a(t,i),new D(V(n,s),F.linear),new D(V(-n,s),F.fastOut),new D(V(P.a.rgb(1,1,.5),P.a.rgb(1,0,0),P.a.rgb(.2,.2,0)),F.linear),e)}tick(){let t=!1;for(let i=0;i<this.maxExplosionIndex;i++)null!==this.explosions[i]&&void 0!==this.explosions[i]&&(this.explosions[i].tick()?this.explosions[i]=null:t=!0);return this.currentBurstDelay--,0===this.currentBurstDelay&&this.triggerExplosions(),!t&&this.maxExplosionIndex===this.explosions.length}draw(t){for(let i=0;i<this.maxExplosionIndex;i++)null!==this.explosions[i]&&void 0!==this.explosions[i]&&this.explosions[i].draw(t)}}var q=e(15);class H{constructor(t,i,e,s,n){this.atlas=t,this.sourceOffset=i,this.sourceSize=e,this.numFrames=s,this.origin=null!=n?n:new m.a(0,0)}draw(t,i,e,s,n){t.save(),t.translate(i.x,i.y),void 0!==n&&t.rotate(n),t.scale(e.x,e.y),t.translate(-this.origin.x,-this.origin.y),t.drawImage(this.atlas.image,this.sourceOffset.x+s*this.sourceSize.x,this.sourceOffset.y,this.sourceSize.x,this.sourceSize.y,0,0,1,1),t.restore()}play(t,i){return new N(this,t,null!=i&&i)}}class N{constructor(t,i,e){this.source=t,this.maxTime=i,this.loop=e,this.currentTime=0}tick(){return this.currentTime++,!(this.currentTime<this.maxTime)&&(this.loop&&(this.currentTime=0),!0)}draw(t,i,e,s){const n=Math.floor(this.currentTime*this.source.numFrames/this.maxTime);this.source.draw(t,i,e,n,s)}}class U{constructor(t,i){this.onload=i,this.image=document.createElement("img"),this.image.src=t,this.image.addEventListener("load",()=>this.loadFinished())}loadFinished(){this.onload()}getSprite(t,i,e,s){return new W(this,t,i,e,s)}getAnimation(t,i,e,s){return new H(this,t,i,s,e)}}class W{constructor(t,i,e,s,n){this.atlas=t,this.sourceOffset=i,this.sourceSize=e,this.origin=null!=s?s:new m.a(0,0),this.sourceRotation=null!=n?n:0}draw(t,i,e,s){t.save(),t.translate(i.x,i.y),t.rotate((null!=s?s:0)+this.sourceRotation),t.scale(e.x,e.y),t.translate(-this.origin.x,-this.origin.y),t.drawImage(this.atlas.image,this.sourceOffset.x,this.sourceOffset.y,this.sourceSize.x,this.sourceSize.y,0,0,1,1),t.restore()}}class C{static normalize(t){return(t%=2*Math.PI)<0&&(t+=2*Math.PI),t}static relativeNormalize(t){var i=C.normalize(t);return i>=Math.PI?i-2*Math.PI:i}static accuteAngle(t,i){return C.relativeNormalize(i-t)}static angleBetween(t,i){return Math.atan2(i.y-t.y,i.x-t.x)}}class G{TickAI(t,i){const e=t.Player,s=C.angleBetween(i.position,e.position),n=C.accuteAngle(i.rotation,s);return{tgtVel:(1-Math.max(0,Math.min(1,Math.abs(n)/Math.PI)))*i.definition.maxSpeed,tgtHeading:s}}}var j,J=e(14);class X{constructor(t,i){this.start=t,this.end=i}ray(){return m.a.subtract(this.end,this.start)}midpoint(){return m.a.interpolate(this.start,this.end,.5)}interpolate(t){return m.a.interpolate(this.start,this.end,t)}static intersection(t,i){const e=(t.start.x-t.end.x)*(i.start.y-i.end.y)-(t.start.y-t.end.y)*(i.start.x-i.end.x);if(0===e)return X.parallelIntersection(t,i);return{percentA:((t.start.x-i.start.x)*(i.start.y-i.end.y)-(t.start.y-i.start.y)*(i.start.x-i.end.x))/e,percentB:((t.end.x-t.start.x)*(t.start.y-i.start.y)-(t.end.y-t.start.y)*(t.start.x-i.start.x))/e}}static parallelIntersection(t,i){const e=t.ray().normalize();function s(i){return m.a.Dot(m.a.subtract(i,t.start),e)}let n=new J.a(s(t.start),s(t.end)),r=new J.a(s(i.start),s(i.end)),a=n.GetPercentage(r.min),o=n.GetPercentage(r.max);return Math.abs(a)<=Math.abs(o)?{percentA:a,percentB:0}:{percentA:o,percentB:1}}}class Y{constructor(t,i,e,s){this.position=t,this.size=i,this.origin=e,this.rotation=s}getVertecies(){let t=[new m.a(0,0),new m.a(this.size.x,0),new m.a(this.size.x,this.size.y),new m.a(0,this.size.y)];return t=t.map(t=>m.a.subtract(t,this.origin)),t=t.map(t=>{const i=Math.atan2(t.y,t.x),e=t.Length();return m.a.fromAngle(i+this.rotation,e)}),t=t.map(t=>m.a.add(t,this.position)),t}getEdges(){return this.getVertecies().map((t,i,e)=>new X(t,e[(i+1)%e.length]))}findLineIntersection(t){let i=this.getEdges(),e=null;for(let s=0;s<i.length;s++){let n=X.intersection(t,i[s]);n.percentA>=0&&n.percentA<1&&n.percentB>=0&&n.percentB<1&&(null===e||n.percentA<e)&&(e=n.percentA)}return e}}class Q{constructor(t,i,e,s,n){this.definition=t,this.position=i,this.rotation=e,this.ai=s,this.team=n,this.Velocity=0,this.lastAccel=this.lastDeccel=this.lastTurn=0,this.currentHp=this.definition.maxHp,this.flares=this.definition.flares.map(t=>t.clone())}getBounds(){return new Y(this.position,this.definition.size,m.a.Multiply(this.definition.origin,this.definition.size),this.rotation)}tick(t,i){const{tgtVel:e,tgtHeading:s}=this.ai.TickAI(i,this);let n=0;if(e<this.Velocity&&this.definition.maxDeccel>0){var r=this.Velocity-e;this.lastDeccel=Math.min(1,r/this.definition.maxDeccel),n=-this.lastDeccel,this.Velocity-=this.lastDeccel*this.definition.maxDeccel}else if(e>this.Velocity){r=e-this.Velocity;this.lastAccel=Math.min(1,r/this.definition.maxAccel),n=this.lastAccel,this.Velocity+=this.lastAccel*this.definition.maxAccel}var a=C.accuteAngle(this.rotation,s),o=Math.sign(a);a=Math.abs(a),this.lastTurn=Math.min(a/this.definition.maxTurnRate,1)*o;for(let t=0;t<this.flares.length;t++)this.flares[t].tick(n,this.lastTurn);return this.rotation+=this.lastTurn*this.definition.maxTurnRate,this.Velocity>=0?this.Velocity=Math.min(this.Velocity,this.definition.maxSpeed):this.Velocity=Math.max(this.Velocity,-this.definition.maxSpeed),this.position.AddWith(m.a.fromAngle(this.rotation,this.Velocity)),this.currentHp>0}render(t){for(let i=0;i<this.flares.length;i++)this.flares[i].draw(t,this.position,this.definition.origin,this.definition.size,this.rotation);this.definition.sprite.draw(t,this.position,this.definition.size,this.rotation)}getTeam(){return this.team}}!function(t){t.Accel="accel",t.Deccel="deccel",t.TurnLeft="turnLeft",t.TurnRight="turnRight"}(j||(j={}));class Z{constructor(t,i,e,s,n,r){this.animation=t,this.offset=i,this.rotation=e,this.conditions="string"==typeof s?[s]:s,this.rotPerTurn=null!=r?r:0,this.minTrigger=null!=n?n:0,this.playing=t.play(30,!0),this.shouldRender=!1}clone(){return new Z(this.animation,this.offset,this.rotation,this.conditions,this.minTrigger,this.rotPerTurn)}tick(t,i){this.shouldRender=!1;for(let e=0;e<this.conditions.length;e++)switch(this.conditions[e]){case j.Accel:this.shouldRender=this.shouldRender||t>this.minTrigger;break;case j.Deccel:this.shouldRender=this.shouldRender||t<-this.minTrigger;break;case j.TurnLeft:this.shouldRender=this.shouldRender||i<-this.minTrigger;break;case j.TurnRight:this.shouldRender=this.shouldRender||i>this.minTrigger}this.adjRot=i*this.rotPerTurn,this.shouldRender&&this.playing.tick()}draw(t,i,e,s,n){if(!this.shouldRender)return;let r=this.offset.Clone();r.SubtractWith(m.a.Multiply(e,s)),r=r.rotate(n),r.AddWith(i);let a=this.adjRot+this.rotation+n;this.playing.draw(t,r,this.animation.sourceSize,a)}}function $(t){return new m.a(t[0],t[1])}class tt{constructor(t,i,e,s,n,r,a,o,h,c,l,u,m){this.size=i,this.origin=n,this.maxHp=r,this.maxAccel=a,this.maxDeccel=o,this.maxSpeed=h,this.turnAccel=c,this.maxTurnRate=l,this.flares=u,this.buildAi=m,this.sprite=t.getSprite(e,s,n)}buildShip(t,i,e){return new Q(this,i,null!=e?e:0,this.buildAi(),t)}}var it=e(84);function et(t,i){return it.map(e=>function(t,i,e){const s=[];for(let i=0;i<t.flares.length;i++){const n=t.flares[i];s.push(new Z(e.getAnimation($(n.animation.imgOffset),$(n.animation.frameSize),$(n.animation.origin),n.animation.numFrames),$(n.offset),n.rotation,n.condition,n.minTrigger,n.rotPerTurn))}return new tt(i,$(t.size),$(t.imgOffset),$(t.size),$(t.origin),t.hp,t.maxAccel,t.maxDeccel,t.maxSpeed,t.turnAccel,t.maxTurnSpeed,s,()=>new G)}(e,t,i))}let st,nt,rt,at;function ot(){const t=new s.a,i=new h.a(8,16,c,t.registerAssetLoadCallback());nt=new U(l,t.registerAssetLoadCallback()),rt=new U(u,t.registerAssetLoadCallback()),t.onAllFinished(()=>function(t){const i=document.getElementById("canvas"),e=i.getContext("2d");st=new a.a(i,e,n,r,!0,()=>{}),Object(o.a)(e),at=nt.getSprite(new m.a(96,0),new m.a(32,48),new m.a(.5,1));let s=et(nt,rt);const h=new R.a(document.body,!1),c=new z(t),l=new A(c,h);l.Effects.push(new E(new m.a(0,0),new D(V(0,30),F.linear),new D(V(-10,30),F.fastOut),new D(V(P.a.rgb(1,1,.5),P.a.rgb(1,0,0),P.a.rgb(.2,.2,0)),F.linear),120)),l.Effects.push(new _(new m.a(100,0),new q.c(-30,30),new q.c(-30,30),new q.c(30,30),4,new q.c(20,40),new q.c(20,60)));for(let t=0;t<s.length;t++)l.Entities[O.ally].push(s[t].buildShip(O.ally,new m.a(-100*(t+1),0),Math.PI/2+Math.random()*Math.PI));!function t(i,e,s,a,h){s.update(),i.tick(),e.tick(s),function(t,i,e,s){Object(o.a)(s),s.fillStyle="black",s.fillRect(0,0,n,r),s.save();const a=m.a.add(i.position,m.a.Multiply(i.velocity,10));s.translate(-(a.x-n/2),-(a.y-r/2)),s.fillStyle="gray";for(let t=400*Math.floor((a.y-r/2)/400);t<=400*Math.floor((a.y+r/2)/400);t+=400)s.fillRect(a.x-n/2,t,n,3);for(let t=400*Math.floor((a.x-n/2)/400);t<=400*Math.floor((a.x+n/2)/400);t+=400)s.fillRect(t,a.y-r/2,3,r);i.render(s),t.draw(s),s.restore()}(i,e,0,h),requestAnimationFrame(()=>t(i,e,s,a,h))}(l,c,h,i,e)}(i))}}}]);
//# sourceMappingURL=bullets.bundle.js.map