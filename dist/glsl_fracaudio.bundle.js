/*! For license information please see glsl_fracaudio.bundle.js.LICENSE.txt */
(self.webpackChunktrading_game=self.webpackChunktrading_game||[]).push([[988],{4403:(e,t)=>{var n;!function(){"use strict";var a={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)&&n.length){var o=r.apply(null,n);o&&e.push(o)}else if("object"===i)for(var s in n)a.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},8167:(e,t,n)=>{"use strict";t.Z=void 0;var a,r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}(n(7363)),i=(a=n(4403))&&a.__esModule?a:{default:a};function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}var f="Select...",p=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?h(e):t}(this,u(t).call(this,e))).state={selected:n.parseValue(e.value,e.options)||{label:void 0===e.placeholder?f:e.placeholder,value:""},isOpen:!1},n.dropdownRef=(0,r.createRef)(),n.mounted=!0,n.handleDocumentClick=n.handleDocumentClick.bind(h(n)),n.fireChangeEvent=n.fireChangeEvent.bind(h(n)),n}var n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(a=[{key:"componentDidUpdate",value:function(e){if(this.props.value!==e.value)if(this.props.value){var t=this.parseValue(this.props.value,this.props.options);t!==this.state.selected&&this.setState({selected:t})}else this.setState({selected:{label:void 0===this.props.placeholder?f:this.props.placeholder,value:""}})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick,!1),document.addEventListener("touchend",this.handleDocumentClick,!1)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,document.removeEventListener("click",this.handleDocumentClick,!1),document.removeEventListener("touchend",this.handleDocumentClick,!1)}},{key:"handleMouseDown",value:function(e){this.props.onFocus&&"function"==typeof this.props.onFocus&&this.props.onFocus(this.state.isOpen),"mousedown"===e.type&&0!==e.button||(e.stopPropagation(),e.preventDefault(),this.props.disabled||this.setState({isOpen:!this.state.isOpen}))}},{key:"parseValue",value:function(e,t){var n;if("string"==typeof e)for(var a=0,r=t.length;a<r;a++)if("group"===t[a].type){var i=t[a].items.filter((function(t){return t.value===e}));i.length&&(n=i[0])}else void 0!==t[a].value&&t[a].value===e&&(n=t[a]);return n||e}},{key:"setValue",value:function(e,t){var n={selected:{value:e,label:t},isOpen:!1};this.fireChangeEvent(n),this.setState(n)}},{key:"fireChangeEvent",value:function(e){e.selected!==this.state.selected&&this.props.onChange&&this.props.onChange(e.selected)}},{key:"renderOption",value:function(e){var t,n=e.value;void 0===n&&(n=e.label||e);var a=e.label||e.value||e,o=n===this.state.selected.value||n===this.state.selected,s=(c(t={},"".concat(this.props.baseClassName,"-option"),!0),c(t,e.className,!!e.className),c(t,"is-selected",o),t),l=(0,i.default)(s);return r.default.createElement("div",{key:n,className:l,onMouseDown:this.setValue.bind(this,n,a),onClick:this.setValue.bind(this,n,a),role:"option","aria-selected":o?"true":"false"},a)}},{key:"buildMenu",value:function(){var e=this,t=this.props,n=t.options,a=t.baseClassName,i=n.map((function(t){if("group"===t.type){var n=r.default.createElement("div",{className:"".concat(a,"-title")},t.name),i=t.items.map((function(t){return e.renderOption(t)}));return r.default.createElement("div",{className:"".concat(a,"-group"),key:t.name,role:"listbox",tabIndex:"-1"},n,i)}return e.renderOption(t)}));return i.length?i:r.default.createElement("div",{className:"".concat(a,"-noresults")},"No options found")}},{key:"handleDocumentClick",value:function(e){this.mounted&&(this.dropdownRef.current.contains(e.target)||this.state.isOpen&&this.setState({isOpen:!1}))}},{key:"isValueSelected",value:function(){return"string"==typeof this.state.selected||""!==this.state.selected.value}},{key:"render",value:function(){var e,t,n,a,o,s=this.props,l=s.baseClassName,u=s.controlClassName,h=s.placeholderClassName,d=s.menuClassName,f=s.arrowClassName,p=s.arrowClosed,m=s.arrowOpen,v=s.className,g=this.props.disabled?"Dropdown-disabled":"",y="string"==typeof this.state.selected?this.state.selected:this.state.selected.label,b=(0,i.default)((c(e={},"".concat(l,"-root"),!0),c(e,v,!!v),c(e,"is-open",this.state.isOpen),e)),w=(0,i.default)((c(t={},"".concat(l,"-control"),!0),c(t,u,!!u),c(t,g,!!g),t)),_=(0,i.default)((c(n={},"".concat(l,"-placeholder"),!0),c(n,h,!!h),c(n,"is-selected",this.isValueSelected()),n)),x=(0,i.default)((c(a={},"".concat(l,"-menu"),!0),c(a,d,!!d),a)),A=(0,i.default)((c(o={},"".concat(l,"-arrow"),!0),c(o,f,!!f),o)),E=r.default.createElement("div",{className:_},y),C=this.state.isOpen?r.default.createElement("div",{className:x,"aria-expanded":"true"},this.buildMenu()):null;return r.default.createElement("div",{ref:this.dropdownRef,className:b},r.default.createElement("div",{className:w,onMouseDown:this.handleMouseDown.bind(this),onTouchEnd:this.handleMouseDown.bind(this),"aria-haspopup":"listbox"},E,r.default.createElement("div",{className:"".concat(l,"-arrow-wrapper")},m&&p?this.state.isOpen?m:p:r.default.createElement("span",{className:A}))),C)}}])&&l(n.prototype,a),t}(r.Component);p.defaultProps={baseClassName:"Dropdown"};var m=p;t.Z=m},3130:(e,t,n)=>{"use strict";function a(e,t,n){const a=e.createShader(t);return e.shaderSource(a,n),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(console.error(n),alert(`An error occurred compiling the ${t===e.VERTEX_SHADER?"vertex":t===e.FRAGMENT_SHADER?"fragment":""} shaders: `+e.getShaderInfoLog(a)),void e.deleteShader(a))}function r(e,t,n){const r=a(e,e.VERTEX_SHADER,t),i=a(e,e.FRAGMENT_SHADER,n),o=e.createProgram();if(e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))return o;alert("Unable to initialize the shader program: "+e.getProgramInfoLog(o))}function i(e,t,n,a,r,i,o,s){e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);{const r=e.FLOAT,i=!1,o=0,s=0;e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(e.getAttribLocation(t,"aVertexPosition"),a,r,i,o,s),e.enableVertexAttribArray(e.getAttribLocation(t,"aVertexPosition"))}e.useProgram(t);for(let t=0;t<i;t++){s(e,t);let{bufferOffset:n,bufferCount:a}=o(t);e.drawArrays("triangle"===r?e.TRIANGLES:"tristrip"===r?e.TRIANGLE_STRIP:e.TRIANGLE_FAN,n,a)}}function o(e,t,n,a){e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);{const a=2,r=e.FLOAT,i=!1,o=0,s=0;e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(e.getAttribLocation(t,"aVertexPosition"),a,r,i,o,s),e.enableVertexAttribArray(e.getAttribLocation(t,"aVertexPosition"))}e.useProgram(t),a(e),e.drawArrays(e.TRIANGLE_STRIP,0,4)}function s(e,t,n,a,r){const i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i);const o=null!=t?t:-1,s=null!=a?a:1,c=null!=n?n:-1,l=null!=r?r:1,u=[l,s,c,s,l,o,c,o];return e.bufferData(e.ARRAY_BUFFER,new Float32Array(u),e.STATIC_DRAW),i}function c(e,t){const n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),n}n.d(t,{nr:()=>r,f:()=>i,os:()=>o,nW:()=>s,jK:()=>c,B_:()=>l,FC:()=>u});const l="attribute vec4 aVertexPosition;\nvarying vec3 vPos;\nvoid main() {\n  vPos = vec3(aVertexPosition.xy, 0.0);\n  gl_Position = aVertexPosition;\n}",u="#version 300 es\nin vec4 aVertexPosition;\nout vec3 vPos;\nvoid main() {\n  vPos = vec3(aVertexPosition.xy, 0.0);\n  gl_Position = aVertexPosition;\n}"},3483:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=new class{constructor(){this.Name="Fire",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    if(perc <= 0.5) {\n        return vec3(perc * 2.0, perc, 0.0);\n    }\n    perc = (perc - 0.5) * 2.0;\n    return vec3(1.0, 0.5 + perc / 2.0, perc);\n}\n    "}}},4811:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=new class{constructor(){this.Name="Grayscale",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    return vec3(perc, perc, perc);\n}\n    "}}},8006:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=new class{constructor(){this.Name="Hue",this.shaderFunction="\n\nfloat fmod(float a, float b) {\n    return a - (b * floor(a/b));\n}\n\nfloat hsvComponentToRgb(vec3 hsv, float n) {\n    float k = fmod((n + hsv.x * 6.0), 6.0);\n    return hsv.z - hsv.z * hsv.y * max(min(min(k, 4.0-k),1.0), 0.0);\n}\n\nvec3 floatToColor(float perc) {\n    if(perc == 1.0) {\n        return vec3(0, 0, 0);\n    }\n    vec3 hsv = vec3(perc, 1.0, 1.0);\n    return vec3(\n        hsvComponentToRgb(hsv, 5.0),\n        hsvComponentToRgb(hsv, 3.0),\n        hsvComponentToRgb(hsv, 1.0)\n    );\n}\n    "}}},3788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=new class{constructor(){this.Name="Paper",this.shaderFunction="\nvec3 floatToColor(float perc) {\n    if(perc == 1.0) {\n        return vec3(0, 0, 0);\n    }\n    return vec3(0.8, 0.8, 0.8) - (perc * 0.8);\n}\n    "}}},4077:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});var a=n(7363),r=n(8167);function i(e){const t=e.options.map(e.getName);return a.createElement(r.Z,{options:t,value:e.getName(e.value),onChange:t=>e.onChange(e.options.find((n=>e.getName(n)===t.value)))})}},6227:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>R});var a=n(7363),r=n(3123);const i=[new class{constructor(){this.Name="Fill"}GetAmplitude(e,t,n){return{min:e,max:t}}},new class{constructor(){this.Name="Square"}GetAmplitude(e,t,n){const a=r.Zz.subtract(t,e);if(a.real===a.imaginary)return{min:e,max:t};if(a.real>a.imaginary){var i=(a.real-a.imaginary)/2,o=new r.Zz(0,i);return{min:r.Zz.subtract(e,o),max:r.Zz.add(t,o)}}return i=(a.imaginary-a.real)/2,o=new r.Zz(i,0),{min:r.Zz.subtract(e,o),max:r.Zz.add(t,o)}}},new class{constructor(){this.Name="Absolute"}GetAmplitude(e,t,n){return{min:new r.Zz(-n.MaxAmplitude,-n.MaxAmplitude),max:new r.Zz(n.MaxAmplitude,n.MaxAmplitude)}}}];var o=n(3483),s=n(4811),c=n(8006),l=n(3788),u=n(5901),h=n(9401);class d{constructor(e,t){this.canvas=e,this.amplitude=t,(0,u.f5)(e,e.clientWidth,e.clientHeight),this.ctx=e.getContext("2d"),this.audio=new AudioContext,this.gain=this.audio.createGain(),this.gain.gain.value=.3,this.gain.connect(this.audio.destination)}Cleanup(){this.audio.close()}Play(e,t){var n;null===(n=this.currentAudio)||void 0===n||n.stop(),this.currentAudio=new f(this.audio,e,t,this.amplitude),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="red",this.currentAudio.start(this.gain),this.ctx.beginPath();const a=h.Z.add(this.currentAudio.maxBounds,h.Z.negate(this.currentAudio.minBounds));for(let e=0;e<this.currentAudio.arr.length;e++){const t=(this.currentAudio.arr[e].real-this.currentAudio.minBounds.real)/a.real,n=(this.currentAudio.arr[e].imaginary-this.currentAudio.minBounds.imaginary)/a.imaginary,r=t*this.canvas.width,i=n*this.canvas.height;0===e?this.ctx.moveTo(r,i):this.ctx.lineTo(r,i)}this.ctx.stroke()}}class f{constructor(e,t,n,a){this.audio=e,this.point=t,this.fractal=n,this.amplitude=a,this.arr=new Array(8820);const r=t;let i=n.Init(r);this.minBounds=new h.Z(1/0,1/0),this.maxBounds=new h.Z(-1/0,-1/0);for(let e=0;e<this.arr.length;e++)i=n.Iterate(i,r),this.arr[e]=new h.Z(i.real,i.imaginary),this.minBounds.real=Math.min(this.minBounds.real,i.real),this.minBounds.imaginary=Math.min(this.minBounds.imaginary,i.imaginary),this.maxBounds.real=Math.max(this.maxBounds.real,i.real),this.maxBounds.imaginary=Math.max(this.maxBounds.imaginary,i.imaginary);const o=a.GetAmplitude(this.minBounds,this.maxBounds,n);this.minBounds=o.min,this.maxBounds=o.max}start(e){const t=this.audio.createBuffer(2,8820,8820),n=this.audio.createBufferSource(),a=[t.getChannelData(0),t.getChannelData(1)],r=h.Z.add(this.maxBounds,h.Z.negate(this.minBounds));for(let e=0;e<a[0].length;e++){const t=8820*e/8820,n=Math.max(0,Math.floor(t)),i=(Math.min(this.arr.length-1,Math.ceil(t)),this.arr[n].real),o=this.arr[n].imaginary,s=(i-this.minBounds.real)/r.real,c=(o-this.minBounds.imaginary)/r.imaginary;a[0][e]=2*s-1,a[1][e]=2*c-1}n.buffer=t,n.connect(e),n.start(),this.source=n}stop(){var e;null===(e=this.source)||void 0===e||e.stop()}}const p=new class{constructor(){this.Name="Burning Ship",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return vec2(0,0);\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        float tx = v.x * v.x - v.y * v.y - c.x;\n        float ty = 2.0 * abs(v.x * v.y) - c.y;\n        return vec2(tx, ty);\n    }\n    ",this.MaxAmplitude=16}Init(e){return e}Iterate(e,t){const n=e.real*e.real-e.imaginary*e.imaginary-t.real,a=2*Math.abs(e.real*e.imaginary)-t.imaginary;return new r.Zz(n,a)}},m=new class{constructor(){this.Name="Feather",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return coords;\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        vec2 denom = scalar_mult(v, v);\n        denom.x += 1.0;\n        vec2 num = cplx_mult(cplx_mult(v, v), v);\n        vec2 result = cplx_div(num, denom);\n        return result + c;\n    }\n    ",this.MaxAmplitude=32}Init(e){return e}Iterate(e,t){return r.Zz.div(r.Zz.mult(e,e).multiplyWith(e),r.Zz.scalarMultiply(e,e).addWith(new r.Zz(1,0))).addWith(t)}},v=new class{constructor(){this.Name="Mandelbrot",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return coords;\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        return cplx_mult(v, v) + c;\n    }\n    ",this.MaxAmplitude=2}Init(e){return e}Iterate(e,t){return r.Zz.mult(e,e).addWith(t)}},g=new class{constructor(){this.Name="Square",this.ShaderCode="\n    vec2 init_fractal(vec2 coords) {\n        return coords;\n    }\n\n    vec2 step_fractal(vec2 v, vec2 c) {\n        float dotz = dot(v, v);\n        vec2 scalarc = scalar_mult(c, c);\n        return v * dotz - cplx_mult(v, scalarc);\n    }\n    ",this.MaxAmplitude=32}Init(e){return e}Iterate(e,t){const n=e.absSq(),a=r.Zz.scalarMultiply(t,t);return r.Zz.subtract(r.Zz.scalarMultiply(e,n,n),r.Zz.mult(t,a))}};var y=n(3130),b=n(8785);class w{constructor(e,t,n,a,i){this.canvas=e,this.fractal=t,this.color=n,this.bounds=a,this.onMiddleClick=i,(0,u.f5)(e,e.clientWidth,e.clientHeight),this.cursor_anchor=null,this.mm_down=!1,this.gl=e.getContext("webgl"),this.touch_anchors={},this.canvasRange=new r.gS(new r.e6(0,e.clientWidth),new r.e6(0,e.clientHeight)),this.windowRange=new r.gS(new r.e6(-1,1),new r.e6(-1,e.height/e.width)),this.fragment_code=function(e,t){return"\nprecision highp float;\nvarying vec3 vPos;\nuniform vec2 window_pos;\nuniform vec2 window_size;\nuniform float MAX_ABSSQ;\n\nconst int MAX_ITER = 256;\n\nvec2 cplx_mult(vec2 a, vec2 b) {\n    return vec2(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}\n\nvec2 cplx_div(vec2 a, vec2 b) {\n    float denom = dot(b, b);\n    return vec2 (\n        (a.x * b.x + a.y * b.y) / denom,\n        (a.y * b.x - a.x * b.y) / denom \n    );\n}\n\nvec2 scalar_mult(vec2 a, vec2 b) {\n    return vec2( a.x * b.x, a.y * b.y);\n}\n\nfloat cplx_abssq(vec2 v) {\n    return dot(v, v);\n}\n\n[[[FRACTAL_CODE]]]\n\nfloat calcIterations(vec2 coords) {\n    vec2 roll = init_fractal(coords);\n    for(int iter = 0; iter < MAX_ITER; iter++) {\n        roll = step_fractal(roll, coords);\n        if (cplx_abssq(roll) >= MAX_ABSSQ) {\n            return float(iter)/float(MAX_ITER);\n        }\n    }\n    return 1.0;\n}\n\n[[[COLOR_CODE]]]\n\nvoid main() {\n    vec2 adjpos = vPos.xy;\n    adjpos += 1.0;\n    adjpos /= 2.0;\n    // adjpos is now 0, 1\n    // Convert that to world-space\n    adjpos = window_pos + adjpos * window_size;\n\n    float mb_perc = calcIterations(adjpos);\n    gl_FragColor = vec4(floatToColor(mb_perc), 1.0);\n}".replace("[[[FRACTAL_CODE]]]",e.ShaderCode).replace("[[[COLOR_CODE]]]",t.shaderFunction)}(t,n),this.init()}init(){this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.initProgram()}initProgram(){this.program=y.nr(this.gl,y.B_,this.fragment_code),this.buffer=y.nW(this.gl)}run(){this.renderFrame(),this.canvas.addEventListener("mousedown",(e=>{if(0===e.button)this.cursor_anchor=new b.Z(e.offsetX,e.offsetY);else if(1===e.button){this.mm_down=!0;let t=this.canvasRange.GetPercentage(e.offsetX,e.offsetY);t=this.windowRange.GetValue(t.x,1-t.y),void 0!==this.onMiddleClick&&this.onMiddleClick(new b.Z(t.x,t.y))}e.preventDefault()})),this.canvas.addEventListener("mouseup",(e=>{0===e.button?this.cursor_anchor=null:1===e.button&&(this.mm_down=!1),e.preventDefault()})),this.canvas.addEventListener("mousemove",(e=>{if(null!=this.cursor_anchor){const t=e.offsetX-this.cursor_anchor.x,n=e.offsetY-this.cursor_anchor.y;this.panCameraByScreenDelta(new b.Z(t,n)),this.cursor_anchor=new b.Z(e.offsetX,e.offsetY),this.renderFrame(),e.preventDefault()}if(this.mm_down&&void 0!==this.onMiddleClick){let t=this.canvasRange.GetPercentage(e.offsetX,e.offsetY);t=this.windowRange.GetValue(t.x,1-t.y),this.onMiddleClick(new b.Z(t.x,t.y))}})),this.canvas.addEventListener("wheel",(e=>{const t=e.deltaY/8,n=Math.pow(1.1,t),a=this.canvasRange.GetPercentage(e.offsetX,e.offsetY);this.windowRange.AspectScale(n,a.x,1-a.y),this.renderFrame(),e.preventDefault()})),this.canvas.addEventListener("touchstart",(e=>{if(!(e.targetTouches.length>=3||0===e.targetTouches.length)){for(let t=0;t<e.targetTouches.length;t++){const n=e.targetTouches.item(t);this.touch_anchors[n.identifier]=_(n)}e.preventDefault()}})),this.canvas.addEventListener("touchmove",(e=>{if(e.touches.length>=3||0===e.touches.length)return;const t=[];for(let n=0;n<e.targetTouches.length;n++){const a=e.targetTouches.item(n),r=_(a),i=this.touch_anchors[a.identifier];if(void 0===i)return;t.push([i,r]),this.touch_anchors[a.identifier]=r}if(1===t.length)this.panCameraByScreenDelta(b.Z.subtract(t[0][1],t[0][0]));else if(2===t.length){const e=b.Z.multiply(b.Z.add(t[0][0],t[1][0]),.5,.5),n=b.Z.multiply(b.Z.add(t[0][1],t[1][1]),.5,.5),a=this.panCameraByScreenDelta(n.subtractWith(e)),r=b.Z.subtract(t[0][0],t[1][0]).length()/b.Z.subtract(t[0][1],t[1][1]).length();this.windowRange.AspectScale(r,a.x,1-a.y)}this.renderFrame(),e.preventDefault()})),this.canvas.addEventListener("touchend",(e=>{this.touch_anchors={},e.preventDefault()})),this.canvas.addEventListener("touchcancel",(e=>{this.touch_anchors={},e.preventDefault()}))}panCameraByScreenDelta(e){const t=this.canvasRange.GetPercentage(e.x,e.y);return this.windowRange.ShiftByPercentage(-t.x,t.y),t}renderFrame(){y.os(this.gl,this.program,this.buffer,(e=>{e.uniform1f(e.getUniformLocation(this.program,"MAX_ABSSQ"),this.fractal.MaxAmplitude),e.uniform2fv(e.getUniformLocation(this.program,"window_pos"),[this.windowRange.xRange.min,this.windowRange.yRange.min]),e.uniform2fv(e.getUniformLocation(this.program,"window_size"),[this.windowRange.xRange.Length(),this.windowRange.yRange.Length()])}))}cleanup(){}}function _(e){const t=e.target.getBoundingClientRect();return new b.Z(e.pageX-t.left,e.pageY-t.top)}class x{constructor(e,t,n,a){this.canvas=e,this.colorFunction=n,this.audioPlayer=a,this.mandelbrot=new w(e,t,n,{x:-2,y:-2,w:4,h:4},(e=>{this.playSound(e,t)})),this.mandelbrot.run()}cleanup(){this.mandelbrot.cleanup()}playSound(e,t){this.audioPlayer.Play(new r.Zz(e.x,e.y),t)}}var A=n(4077);const E=[v,p,m,g],C=[s.Z,o.Z,c.Z,l.Z];function R(){const e=a.useRef(),t=a.useRef(),[n,r]=a.useState(v),[s,c]=a.useState(i[0]),[l,u]=a.useState(o.Z);return a.useEffect((()=>{const a=new d(t.current,s),r=new x(e.current,n,l,a);return()=>{r.cleanup(),a.Cleanup()}}),[e,n,s,l]),a.createElement("div",{className:"conway conway_body full_body"},a.createElement("div",{style:{width:"80%",height:"100%",position:"absolute"}},a.createElement("canvas",{ref:e,style:{position:"absolute",width:"100%",height:"100%",top:0,left:0}}),a.createElement("canvas",{ref:t,style:{position:"absolute",width:"100%",height:"100%",pointerEvents:"none",top:0,left:0}})),a.createElement("div",{style:{width:"20%",height:"100%",background:"#333",position:"absolute",left:"80%"}},a.createElement("label",null,"Fractal:"),a.createElement(A.f,{options:E,value:n,getName:e=>e.Name,onChange:e=>r(e)}),a.createElement("label",null,"Color:"),a.createElement(A.f,{options:C,value:l,getName:e=>e.Name,onChange:e=>u(e)}),a.createElement("label",null,"Amplitude Function:"),a.createElement(A.f,{options:i,value:s,getName:e=>e.Name,onChange:e=>c(e)}),a.createElement("div",{style:{bottom:0,position:"absolute",color:"#999",textAlign:"center",width:"100%"}},"Inspired by ",a.createElement("a",{href:"https://www.youtube.com/watch?v=GiAj9WW1OfQ"},"this video"))))}}}]);
//# sourceMappingURL=glsl_fracaudio.bundle.js.map